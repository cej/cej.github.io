/*
* 3Play Media P3SDK, v1.10.7 - Manatee

* 3Play Media: Cambridge, MA, USA
* support@3playmedia.com
* Â©2019 3Play Media, Inc.  The following software is the sole and exclusive property of 3Play Media, Inc. and may not to be reproduced, modified, distributed or otherwise used, without the written approval of 3Play Media, Inc.  We have granted approval to our paying customers while they are our customers to reproduce, modify and use (but not distribute) this software for their own internal use only.  This means that if you are not a paying customer of 3Play Media, Inc., you may not reproduce, modify, distribute or otherwise use the code.
* Paying customers who are permitted and do use this software are hereby advised that this software is provided "as is" and any express or implied warranties, including but not limited to, an implied warranty of merchantability and fitness for a particular purpose are disclaimed.  In no event shall 3Play Media, Inc. be liable for any direct, indirect, incidental, special, exemplary, or consequential damages (including but not limited to, procurement or substitute goods or services, loss of use, data or profits, or business interruption) however caused and on any theory of liability, whether in contract, strict liability, or tort (including negligence or otherwise) arising in any way out of the use of this software, even if advised of the possibility of such damage.
*/
if(void 0===Zepto){var Zepto=function(){function t(t){return null==t?String(t):B[G.call(t)]||"object"}function e(e){return"function"==t(e)}function n(t){return null!=t&&t==t.window}function i(t){return null!=t&&t.nodeType==t.DOCUMENT_NODE}function a(e){return"object"==t(e)}function r(t){return a(t)&&!n(t)&&Object.getPrototypeOf(t)==Object.prototype}function s(t){return"number"==typeof t.length}function o(t){return A.call(t,function(t){return null!=t})}function p(t){return t.length>0?b.fn.concat.apply([],t):t}function c(t){return t.replace(/::/g,"/").replace(/([A-Z]+)([A-Z][a-z])/g,"$1_$2").replace(/([a-z\d])([A-Z])/g,"$1_$2").replace(/_/g,"-").toLowerCase()}function u(t){return t in N?N[t]:N[t]=new RegExp("(^|\\s)"+t+"(\\s|$)")}function l(t,e){return"number"!=typeof e||j[c(t)]?e:e+"px"}function d(t){var e,n;return C[t]||(e=T.createElement(t),T.body.appendChild(e),n=getComputedStyle(e,"").getPropertyValue("display"),e.parentNode.removeChild(e),"none"==n&&(n="block"),C[t]=n),C[t]}function h(t){return"children"in t?E.call(t.children):b.map(t.childNodes,function(t){return 1==t.nodeType?t:void 0})}function f(t,e,n){for(w in e)n&&(r(e[w])||X(e[w]))?(r(e[w])&&!r(t[w])&&(t[w]={}),X(e[w])&&!X(t[w])&&(t[w]=[]),f(t[w],e[w],n)):e[w]!==$&&(t[w]=e[w])}function _(t,e){return null==e?b(t):b(t).filter(e)}function y(t,n,i,a){return e(n)?n.call(t,i,a):n}function m(t,e,n){null==n?t.removeAttribute(e):t.setAttribute(e,n)}function g(t,e){var n=t.className||"",i=n&&n.baseVal!==$;return e===$?i?n.baseVal:n:void(i?n.baseVal=e:t.className=e)}function v(t){try{return t?"true"==t||"false"!=t&&("null"==t?null:+t+""==t?+t:/^[\[\{]/.test(t)?b.parseJSON(t):t):t}catch(w){return t}}function k(t,e){e(t);for(var n=0,i=t.childNodes.length;i>n;n++)k(t.childNodes[n],e)}var $,w,b,P,S,x,I=[],E=I.slice,A=I.filter,T=window.document,C={},N={},j={"column-count":1,columns:1,"font-weight":1,"line-height":1,opacity:1,"z-index":1,zoom:1},L=/^\s*<(\w+|!)[^>]*>/,D=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,V=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,q=/^(?:body|html)$/i,z=/([A-Z])/g,M=["val","css","html","text","data","width","height","offset"],O=["after","prepend","before","append"],U=T.createElement("table"),H=T.createElement("tr"),F={tr:T.createElement("tbody"),tbody:U,thead:U,tfoot:U,td:H,th:H,"*":T.createElement("div")},Y=/complete|loaded|interactive/,R=/^[\w-]*$/,B={},G=B.toString,J={},Z=T.createElement("div"),W={tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},X=Array.isArray||function(t){return t instanceof Array};return J.matches=function(t,e){if(!e||!t||1!==t.nodeType)return!1;var n=t.webkitMatchesSelector||t.mozMatchesSelector||t.oMatchesSelector||t.matchesSelector;if(n)return n.call(t,e);var i,a=t.parentNode,r=!a;return r&&(a=Z).appendChild(t),i=~J.qsa(a,e).indexOf(t),r&&Z.removeChild(t),i},S=function(t){return t.replace(/-+(.)?/g,function(t,e){return e?e.toUpperCase():""})},x=function(t){return A.call(t,function(e,n){return t.indexOf(e)==n})},J.fragment=function(t,e,n){var i,a,s;return D.test(t)&&(i=b(T.createElement(RegExp.$1))),i||(t.replace&&(t=t.replace(V,"<$1></$2>")),e===$&&(e=L.test(t)&&RegExp.$1),e in F||(e="*"),(s=F[e]).innerHTML=""+t,i=b.each(E.call(s.childNodes),function(){s.removeChild(this)})),r(n)&&(a=b(i),b.each(n,function(t,e){M.indexOf(t)>-1?a[t](e):a.attr(t,e)})),i},J.Z=function(t,e){return(t=t||[]).__proto__=b.fn,t.selector=e||"",t},J.isZ=function(t){return t instanceof J.Z},J.init=function(t,n){var i;if(!t)return J.Z();if("string"==typeof t)if("<"==(t=t.trim())[0]&&L.test(t))i=J.fragment(t,RegExp.$1,n),t=null;else{if(n!==$)return b(n).find(t);i=J.qsa(T,t)}else{if(e(t))return b(T).ready(t);if(J.isZ(t))return t;if(X(t))i=o(t);else if(a(t))i=[t],t=null;else if(L.test(t))i=J.fragment(t.trim(),RegExp.$1,n),t=null;else{if(n!==$)return b(n).find(t);i=J.qsa(T,t)}}return J.Z(i,t)},(b=function(t,e){return J.init(t,e)}).extend=function(t){var e,n=E.call(arguments,1);return"boolean"==typeof t&&(e=t,t=n.shift()),n.forEach(function(n){f(t,n,e)}),t},J.qsa=function(t,e){var n,a="#"==e[0],r=!a&&"."==e[0],s=a||r?e.slice(1):e,o=R.test(s);return i(t)&&o&&a?(n=t.getElementById(s))?[n]:[]:1!==t.nodeType&&9!==t.nodeType?[]:E.call(o&&!a?r?t.getElementsByClassName(s):t.getElementsByTagName(e):t.querySelectorAll(e))},b.contains=T.documentElement.contains?function(t,e){return t!==e&&t.contains(e)}:function(t,e){for(;e&&(e=e.parentNode);)if(e===t)return!0;return!1},b.type=t,b.isFunction=e,b.isWindow=n,b.isArray=X,b.isPlainObject=r,b.isEmptyObject=function(t){var e;for(e in t)return!1;return!0},b.inArray=function(t,e,n){return I.indexOf.call(e,t,n)},b.camelCase=S,b.trim=function(t){return null==t?"":String.prototype.trim.call(t)},b.uuid=0,b.support={},b.expr={},b.map=function(t,e){var n,i,a,r=[];if(s(t))for(i=0;i<t.length;i++)null!=(n=e(t[i],i))&&r.push(n);else for(a in t)null!=(n=e(t[a],a))&&r.push(n);return p(r)},b.each=function(t,e){var n,i;if(s(t)){for(n=0;n<t.length;n++)if(!1===e.call(t[n],n,t[n]))return t}else for(i in t)if(!1===e.call(t[i],i,t[i]))return t;return t},b.grep=function(t,e){return A.call(t,e)},window.JSON&&(b.parseJSON=JSON.parse),b.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){B["[object "+e+"]"]=e.toLowerCase()}),b.fn={forEach:I.forEach,reduce:I.reduce,push:I.push,sort:I.sort,indexOf:I.indexOf,concat:I.concat,map:function(t){return b(b.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return b(E.apply(this,arguments))},ready:function(t){return Y.test(T.readyState)&&T.body?t(b):T.addEventListener("DOMContentLoaded",function(){t(b)},!1),this},get:function(t){return t===$?E.call(this):this[t>=0?t:t+this.length]},toArray:function(){return this.get()},size:function(){return this.length},remove:function(){return this.each(function(){null!=this.parentNode&&this.parentNode.removeChild(this)})},each:function(t){return I.every.call(this,function(e,n){return!1!==t.call(e,n,e)}),this},filter:function(t){return e(t)?this.not(this.not(t)):b(A.call(this,function(e){return J.matches(e,t)}))},add:function(t,e){return b(x(this.concat(b(t,e))))},is:function(t){return this.length>0&&J.matches(this[0],t)},not:function(t){var n=[];if(e(t)&&t.call!==$)this.each(function(e){t.call(this,e)||n.push(this)});else{var i="string"==typeof t?this.filter(t):s(t)&&e(t.item)?E.call(t):b(t);this.forEach(function(t){i.indexOf(t)<0&&n.push(t)})}return b(n)},has:function(t){return this.filter(function(){return a(t)?b.contains(this,t):b(this).find(t).size()})},eq:function(t){return-1===t?this.slice(t):this.slice(t,+t+1)},first:function(){var t=this[0];return t&&!a(t)?t:b(t)},last:function(){var t=this[this.length-1];return t&&!a(t)?t:b(t)},find:function(t){var e=this;return t?"object"==typeof t?b(t).filter(function(){var t=this;return I.some.call(e,function(e){return b.contains(e,t)})}):1==this.length?b(J.qsa(this[0],t)):this.map(function(){return J.qsa(this,t)}):b()},closest:function(t,e){var n=this[0],a=!1;for("object"==typeof t&&(a=b(t));n&&!(a?a.indexOf(n)>=0:J.matches(n,t));)n=n!==e&&!i(n)&&n.parentNode;return b(n)},parents:function(t){for(var e=[],n=this;n.length>0;)n=b.map(n,function(t){return(t=t.parentNode)&&!i(t)&&e.indexOf(t)<0?(e.push(t),t):void 0});return _(e,t)},parent:function(t){return _(x(this.pluck("parentNode")),t)},children:function(t){return _(this.map(function(){return h(this)}),t)},contents:function(){return this.map(function(){return E.call(this.childNodes)})},siblings:function(t){return _(this.map(function(t,e){return A.call(h(e.parentNode),function(t){return t!==e})}),t)},empty:function(){return this.each(function(){this.innerHTML=""})},pluck:function(t){return b.map(this,function(e){return e[t]})},show:function(){return this.each(function(){"none"==this.style.display&&(this.style.display=""),"none"==getComputedStyle(this,"").getPropertyValue("display")&&(this.style.display=d(this.nodeName))})},replaceWith:function(t){return this.before(t).remove()},wrap:function(t){var n=e(t);if(this[0]&&!n)var i=b(t).get(0),a=i.parentNode||this.length>1;return this.each(function(e){b(this).wrapAll(n?t.call(this,e):a?i.cloneNode(!0):i)})},wrapAll:function(t){if(this[0]){b(this[0]).before(t=b(t));for(var e;(e=t.children()).length;)t=e.first();b(t).append(this)}return this},wrapInner:function(t){var n=e(t);return this.each(function(e){var i=b(this),a=i.contents(),r=n?t.call(this,e):t;a.length?a.wrapAll(r):i.append(r)})},unwrap:function(){return this.parent().each(function(){b(this).replaceWith(b(this).children())}),this},clone:function(){return this.map(function(){return this.cloneNode(!0)})},hide:function(){return this.css("display","none")},toggle:function(t){return this.each(function(){var e=b(this);(t===$?"none"==e.css("display"):t)?e.show():e.hide()})},prev:function(t){return b(this.pluck("previousElementSibling")).filter(t||"*")},next:function(t){return b(this.pluck("nextElementSibling")).filter(t||"*")},html:function(t){return 0 in arguments?this.each(function(e){var n=this.innerHTML;b(this).empty().append(y(this,t,e,n))}):0 in this?this[0].innerHTML:null},text:function(t){return 0 in arguments?this.each(function(e){var n=y(this,t,e,this.textContent);this.textContent=null==n?"":""+n}):0 in this?this[0].textContent:null},attr:function(t,e){var n;return"string"!=typeof t||1 in arguments?this.each(function(n){if(1===this.nodeType)if(a(t))for(w in t)m(this,w,t[w]);else m(this,t,y(this,e,n,this.getAttribute(t)))}):this.length&&1===this[0].nodeType?!(n=this[0].getAttribute(t))&&t in this[0]?this[0][t]:n:$},removeAttr:function(t){return this.each(function(){1===this.nodeType&&t.split(" ").forEach(function(t){m(this,t)},this)})},prop:function(t,e){return t=W[t]||t,1 in arguments?this.each(function(n){this[t]=y(this,e,n,this[t])}):this[0]&&this[0][t]},data:function(t,e){var n="data-"+t.replace(z,"-$1").toLowerCase(),i=1 in arguments?this.attr(n,e):this.attr(n);return null!==i?v(i):$},val:function(t){return 0 in arguments?this.each(function(e){this.value=y(this,t,e,this.value)}):this[0]&&(this[0].multiple?b(this[0]).find("option").filter(function(){return this.selected}).pluck("value"):this[0].value)},offset:function(t){if(t)return this.each(function(e){var n=b(this),i=y(this,t,e,n.offset()),a=n.offsetParent().offset(),r={top:i.top-a.top,left:i.left-a.left};"static"==n.css("position")&&(r.position="relative"),n.css(r)});if(!this.length)return null;var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:Math.round(e.width),height:Math.round(e.height)}},css:function(e,n){if(arguments.length<2){var i,a=this[0];if(!a)return;if(i=getComputedStyle(a,""),"string"==typeof e)return a.style[S(e)]||i.getPropertyValue(e);if(X(e)){var r={};return b.each(e,function(t,e){r[e]=a.style[S(e)]||i.getPropertyValue(e)}),r}}var s="";if("string"==t(e))n||0===n?s=c(e)+":"+l(e,n):this.each(function(){this.style.removeProperty(c(e))});else for(w in e)e[w]||0===e[w]?s+=c(w)+":"+l(w,e[w])+";":this.each(function(){this.style.removeProperty(c(w))});return this.each(function(){this.style.cssText+=";"+s})},index:function(t){return t?this.indexOf(b(t)[0]):this.parent().children().indexOf(this[0])},hasClass:function(t){return!!t&&I.some.call(this,function(t){return this.test(g(t))},u(t))},addClass:function(t){return t?this.each(function(e){if("className"in this){P=[];var n=g(this);y(this,t,e,n).split(/\s+/g).forEach(function(t){b(this).hasClass(t)||P.push(t)},this),P.length&&g(this,n+(n?" ":"")+P.join(" "))}}):this},removeClass:function(t){return this.each(function(e){if("className"in this){if(t===$)return g(this,"");P=g(this),y(this,t,e,P).split(/\s+/g).forEach(function(t){P=P.replace(u(t)," ")}),g(this,P.trim())}})},toggleClass:function(t,e){return t?this.each(function(n){var i=b(this);y(this,t,n,g(this)).split(/\s+/g).forEach(function(t){(e===$?!i.hasClass(t):e)?i.addClass(t):i.removeClass(t)})}):this},scrollTop:function(t){if(this.length){var e="scrollTop"in this[0];return t===$?e?this[0].scrollTop:this[0].pageYOffset:this.each(e?function(){this.scrollTop=t}:function(){this.scrollTo(this.scrollX,t)})}},scrollLeft:function(t){if(this.length){var e="scrollLeft"in this[0];return t===$?e?this[0].scrollLeft:this[0].pageXOffset:this.each(e?function(){this.scrollLeft=t}:function(){this.scrollTo(t,this.scrollY)})}},position:function(){if(this.length){var t=this[0],e=this.offsetParent(),n=this.offset(),i=q.test(e[0].nodeName)?{top:0,left:0}:e.offset();return n.top-=parseFloat(b(t).css("margin-top"))||0,n.left-=parseFloat(b(t).css("margin-left"))||0,i.top+=parseFloat(b(e[0]).css("border-top-width"))||0,i.left+=parseFloat(b(e[0]).css("border-left-width"))||0,{top:n.top-i.top,left:n.left-i.left}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||T.body;t&&!q.test(t.nodeName)&&"static"==b(t).css("position");)t=t.offsetParent;return t})}},b.fn.detach=b.fn.remove,["width","height"].forEach(function(t){var e=t.replace(/./,function(t){return t[0].toUpperCase()});b.fn[t]=function(a){var r,s=this[0];return a===$?n(s)?s["inner"+e]:i(s)?s.documentElement["scroll"+e]:(r=this.offset())&&r[t]:this.each(function(e){(s=b(this)).css(t,y(this,a,e,s[t]()))})}}),O.forEach(function(e,n){var i=n%2;b.fn[e]=function(){var e,a,r=b.map(arguments,function(n){return"object"==(e=t(n))||"array"==e||null==n?n:J.fragment(n)}),s=this.length>1;return r.length<1?this:this.each(function(t,e){a=i?e:e.parentNode,e=0==n?e.nextSibling:1==n?e.firstChild:2==n?e:null;var o=b.contains(T.documentElement,a);r.forEach(function(t){if(s)t=t.cloneNode(!0);else if(!a)return b(t).remove();a.insertBefore(t,e),o&&k(t,function(t){null==t.nodeName||"SCRIPT"!==t.nodeName.toUpperCase()||t.type&&"text/javascript"!==t.type||t.src||window.eval.call(window,t.innerHTML)})})})},b.fn[i?e+"To":"insert"+(n?"Before":"After")]=function(t){return b(t)[e](this),this}}),J.Z.prototype=b.fn,J.uniq=x,J.deserializeValue=v,b.zepto=J,b}();window.Zepto=Zepto,void 0===window.$&&(window.$=Zepto),function(t){function e(t){return t._zid||(t._zid=d++)}function n(t,n,r,s){if((n=i(n)).ns)var o=a(n.ns);return(y[e(t)]||[]).filter(function(t){return!(!t||n.e&&t.e!=n.e||n.ns&&!o.test(t.ns)||r&&e(t.fn)!==e(r)||s&&t.sel!=s)})}function i(t){var e=(""+t).split(".");return{e:e[0],ns:e.slice(1).sort().join(" ")}}function a(t){return new RegExp("(?:^| )"+t.replace(" "," .* ?")+"(?: |$)")}function r(t,e){return t.del&&!g&&t.e in v||!!e}function s(t){return k[t]||g&&v[t]||t}function o(n,a,o,p,u,d,h){var f=e(n),_=y[f]||(y[f]=[]);a.split(/\s/).forEach(function(e){if("ready"==e)return t(document).ready(o);var a=i(e);a.fn=o,a.sel=u,a.e in k&&(o=function(e){var n=e.relatedTarget;return!n||n!==this&&!t.contains(this,n)?a.fn.apply(this,arguments):void 0}),a.del=d;var f=d||o;a.proxy=function(t){if(!(t=c(t)).isImmediatePropagationStopped()){t.data=p;var e=f.apply(n,t._args==l?[t]:[t].concat(t._args));return!1===e&&(t.preventDefault(),t.stopPropagation()),e}},a.i=_.length,_.push(a),"addEventListener"in n&&n.addEventListener(s(a.e),a.proxy,r(a,h))})}function p(t,i,a,o,p){var c=e(t);(i||"").split(/\s/).forEach(function(e){n(t,e,a,o).forEach(function(e){delete y[c][e.i],"removeEventListener"in t&&t.removeEventListener(s(e.e),e.proxy,r(e,p))})})}function c(e,n){return(n||!e.isDefaultPrevented)&&(n||(n=e),t.each(P,function(t,i){var a=n[t];e[t]=function(){return this[i]=$,a&&a.apply(n,arguments)},e[i]=w}),(n.defaultPrevented!==l?n.defaultPrevented:"returnValue"in n?!1===n.returnValue:n.getPreventDefault&&n.getPreventDefault())&&(e.isDefaultPrevented=$)),e}function u(t){var e,n={originalEvent:t};for(e in t)b.test(e)||t[e]===l||(n[e]=t[e]);return c(n,t)}var l,d=1,h=Array.prototype.slice,f=t.isFunction,_=function(t){return"string"==typeof t},y={},m={},g="onfocusin"in window,v={focus:"focusin",blur:"focusout"},k={mouseenter:"mouseover",mouseleave:"mouseout"};m.click=m.mousedown=m.mouseup=m.mousemove="MouseEvents",t.event={add:o,remove:p},t.proxy=function(n,i){var a=2 in arguments&&h.call(arguments,2);if(f(n)){var r=function(){return n.apply(i,a?a.concat(h.call(arguments)):arguments)};return r._zid=e(n),r}if(_(i))return a?(a.unshift(n[i],n),t.proxy.apply(null,a)):t.proxy(n[i],n);throw new TypeError("expected function")},t.fn.bind=function(t,e,n){return this.on(t,e,n)},t.fn.unbind=function(t,e){return this.off(t,e)},t.fn.one=function(t,e,n,i){return this.on(t,e,n,i,1)};var $=function(){return!0},w=function(){return!1},b=/^([A-Z]|returnValue$|layer[XY]$)/,P={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"};t.fn.delegate=function(t,e,n){return this.on(e,t,n)},t.fn.undelegate=function(t,e,n){return this.off(e,t,n)},t.fn.live=function(e,n){return t(document.body).delegate(this.selector,e,n),this},t.fn.die=function(e,n){return t(document.body).undelegate(this.selector,e,n),this},t.fn.on=function(e,n,i,a,r){var s,c,d=this;return e&&!_(e)?(t.each(e,function(t,e){d.on(t,n,i,e,r)}),d):(_(n)||f(a)||!1===a||(a=i,i=n,n=l),(f(i)||!1===i)&&(a=i,i=l),!1===a&&(a=w),d.each(function(l,d){r&&(s=function(t){return p(d,t.type,a),a.apply(this,arguments)}),n&&(c=function(e){var i,r=t(e.target).closest(n,d).get(0);return r&&r!==d?(i=t.extend(u(e),{currentTarget:r,liveFired:d}),(s||a).apply(r,[i].concat(h.call(arguments,1)))):void 0}),o(d,e,a,i,n,c||s)}))},t.fn.off=function(e,n,i){var a=this;return e&&!_(e)?(t.each(e,function(t,e){a.off(t,n,e)}),a):(_(n)||f(i)||!1===i||(i=n,n=l),!1===i&&(i=w),a.each(function(){p(this,e,i,n)}))},t.fn.trigger=function(e,n){return(e=_(e)||t.isPlainObject(e)?t.Event(e):c(e))._args=n,this.each(function(){e.type in v&&"function"==typeof this[e.type]?this[e.type]():"dispatchEvent"in this?this.dispatchEvent(e):t(this).triggerHandler(e,n)})},t.fn.triggerHandler=function(e,i){var a,r;return this.each(function(s,o){(a=u(_(e)?t.Event(e):e))._args=i,a.target=o,t.each(n(o,e.type||e),function(t,e){return r=e.proxy(a),!a.isImmediatePropagationStopped()&&void 0})}),r},"focusin focusout focus blur load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select keydown keypress keyup error".split(" ").forEach(function(e){t.fn[e]=function(t){return 0 in arguments?this.bind(e,t):this.trigger(e)}}),t.Event=function(t,e){_(t)||(t=(e=t).type);var n=document.createEvent(m[t]||"Events"),i=!0;if(e)for(var a in e)"bubbles"==a?i=!!e[a]:n[a]=e[a];return n.initEvent(t,i,!0),c(n)}}(Zepto),function(t){function e(e,n,i){var a=t.Event(n);return t(e).trigger(a,i),!a.isDefaultPrevented()}function n(t,n,i,a){return t.global?e(n||g,i,a):void 0}function i(e){e.global&&0==t.active++&&n(e,null,"ajaxStart")}function a(e){e.global&&!--t.active&&n(e,null,"ajaxStop")}function r(t,e){var i=e.context;return!1!==e.beforeSend.call(i,t,e)&&!1!==n(e,i,"ajaxBeforeSend",[t,e])&&void n(e,i,"ajaxSend",[t,e])}function s(t,e,i,a){var r=i.context,s="success";i.success.call(r,t,s,e),a&&a.resolveWith(r,[t,s,e]),n(i,r,"ajaxSuccess",[e,i,t]),p(s,e,i)}function o(t,e,i,a,r){var s=a.context;a.error.call(s,i,e,t),r&&r.rejectWith(s,[i,e,t]),n(a,s,"ajaxError",[i,a,t||e]),p(e,i,a)}function p(t,e,i){var r=i.context;i.complete.call(r,e,t),n(i,r,"ajaxComplete",[e,i]),a(i)}function c(){}function u(t){return t&&(t=t.split(";",2)[0]),t&&(t==b?"html":t==w?"json":k.test(t)?"script":$.test(t)&&"xml")||"text"}function l(t,e){return""==e?t:(t+"&"+e).replace(/[&?]{1,2}/,"?")}function d(e){e.processData&&e.data&&"string"!=t.type(e.data)&&(e.data=t.param(e.data,e.traditional)),!e.data||e.type&&"GET"!=e.type.toUpperCase()||(e.url=l(e.url,e.data),e.data=void 0)}function h(e,n,i,a){return t.isFunction(n)&&(a=i,i=n,n=void 0),t.isFunction(i)||(a=i,i=void 0),{url:e,data:n,success:i,dataType:a}}function f(e,n,i,a){var r,s=t.isArray(n),o=t.isPlainObject(n);t.each(n,function(n,p){r=t.type(p),a&&(n=i?a:a+"["+(o||"object"==r||"array"==r?n:"")+"]"),!a&&s?e.add(p.name,p.value):"array"==r||!i&&"object"==r?f(e,p,i,n):e.add(n,p)})}var _,y,m=0,g=window.document,v=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,k=/^(?:text|application)\/javascript/i,$=/^(?:text|application)\/xml/i,w="application/json",b="text/html",P=/^\s*$/,S=g.createElement("a");S.href=window.location.href,t.active=0,t.ajaxJSONP=function(e,n){if(!("type"in e))return t.ajax(e);var i,a,p=e.jsonpCallback,c=(t.isFunction(p)?p():p)||"jsonp"+ ++m,u=g.createElement("script"),l=window[c],d=function(e){t(u).triggerHandler("error",e||"abort")},h={abort:d};return n&&n.promise(h),t(u).on("load error",function(r,p){clearTimeout(a),t(u).off().remove(),"error"!=r.type&&i?s(i[0],h,e,n):o(null,p||"error",h,e,n),window[c]=l,i&&t.isFunction(l)&&l(i[0]),l=i=void 0}),!1===r(h,e)?(d("abort"),h):(window[c]=function(){i=arguments},u.src=e.url.replace(/\?(.+)=\?/,"?$1="+c),g.head.appendChild(u),e.timeout>0&&(a=setTimeout(function(){d("timeout")},e.timeout)),h)},t.ajaxSettings={type:"GET",beforeSend:c,success:c,error:c,complete:c,context:null,global:!0,xhr:function(){return new window.XMLHttpRequest},accepts:{script:"text/javascript, application/javascript, application/x-javascript",json:w,xml:"application/xml, text/xml",html:b,text:"text/plain"},crossDomain:!1,timeout:0,processData:!0,cache:!0},t.ajax=function(e){var n,a=t.extend({},e||{}),p=t.Deferred&&t.Deferred();for(_ in t.ajaxSettings)void 0===a[_]&&(a[_]=t.ajaxSettings[_]);i(a),a.crossDomain||((n=g.createElement("a")).href=a.url,n.href=n.href,a.crossDomain=S.protocol+"//"+S.host!=n.protocol+"//"+n.host),a.url||(a.url=window.location.toString()),d(a);var h=a.dataType,f=/\?.+=\?/.test(a.url);if(f&&(h="jsonp"),!1!==a.cache&&(e&&!0===e.cache||"script"!=h&&"jsonp"!=h)||(a.url=l(a.url,"_="+Date.now())),"jsonp"==h)return f||(a.url=l(a.url,a.jsonp?a.jsonp+"=?":!1===a.jsonp?"":"callback=?")),t.ajaxJSONP(a,p);var m,v=a.accepts[h],k={},$=function(t,e){k[t.toLowerCase()]=[t,e]},w=/^([\w-]+:)\/\//.test(a.url)?RegExp.$1:window.location.protocol,b=a.xhr(),x=b.setRequestHeader;if(p&&p.promise(b),a.crossDomain||$("X-Requested-With","XMLHttpRequest"),$("Accept",v||"*/*"),(v=a.mimeType||v)&&(v.indexOf(",")>-1&&(v=v.split(",",2)[0]),b.overrideMimeType&&b.overrideMimeType(v)),(a.contentType||!1!==a.contentType&&a.data&&"GET"!=a.type.toUpperCase())&&$("Content-Type",a.contentType||"application/x-www-form-urlencoded"),a.headers)for(y in a.headers)$(y,a.headers[y]);if(b.setRequestHeader=$,b.onreadystatechange=function(){if(4==b.readyState){b.onreadystatechange=c,clearTimeout(m);var e,n=!1;if(b.status>=200&&b.status<300||304==b.status||0==b.status&&"file:"==w){h=h||u(a.mimeType||b.getResponseHeader("content-type")),e=b.responseText;try{"script"==h?(0,eval)(e):"xml"==h?e=b.responseXML:"json"==h&&(e=P.test(e)?null:t.parseJSON(e))}catch(_){n=_}n?o(n,"parsererror",b,a,p):s(e,b,a,p)}else o(b.statusText||null,b.status?"error":"abort",b,a,p)}},!1===r(b,a))return b.abort(),o(null,"abort",b,a,p),b;if(a.xhrFields)for(y in a.xhrFields)b[y]=a.xhrFields[y];var I=!("async"in a)||a.async;for(y in b.open(a.type,a.url,I,a.username,a.password),k)x.apply(b,k[y]);return a.timeout>0&&(m=setTimeout(function(){b.onreadystatechange=c,b.abort(),o(null,"timeout",b,a,p)},a.timeout)),b.send(a.data?a.data:null),b},t.get=function(){return t.ajax(h.apply(null,arguments))},t.post=function(){var e=h.apply(null,arguments);return e.type="POST",t.ajax(e)},t.getJSON=function(){var e=h.apply(null,arguments);return e.dataType="json",t.ajax(e)},t.fn.load=function(e,n,i){if(!this.length)return this;var a,r=this,s=e.split(/\s/),o=h(e,n,i),p=o.success;return s.length>1&&(o.url=s[0],a=s[1]),o.success=function(e){r.html(a?t("<div>").html(e.replace(v,"")).find(a):e),p&&p.apply(r,arguments)},t.ajax(o),this};var x=encodeURIComponent;t.param=function(e,n){var i=[];return i.add=function(e,n){t.isFunction(n)&&(n=n()),null==n&&(n=""),this.push(x(e)+"="+x(n))},f(i,e,n),i.join("&").replace(/%20/g,"+")}}(Zepto),function(t){t.fn.serializeArray=function(){var e,n,i=[],a=function(t){return t.forEach?t.forEach(a):void i.push({name:e,value:t})};return this[0]&&t.each(this[0].elements,function(i,r){n=r.type,(e=r.name)&&"fieldset"!=r.nodeName.toLowerCase()&&!r.disabled&&"submit"!=n&&"reset"!=n&&"button"!=n&&"file"!=n&&("radio"!=n&&"checkbox"!=n||r.checked)&&a(t(r).val())}),i},t.fn.serialize=function(){var t=[];return this.serializeArray().forEach(function(e){t.push(encodeURIComponent(e.name)+"="+encodeURIComponent(e.value))}),t.join("&")},t.fn.submit=function(e){if(0 in arguments)this.bind("submit",e);else if(this.length){var n=t.Event("submit");this.eq(0).trigger(n),n.isDefaultPrevented()||this.get(0).submit()}return this}}(Zepto),function(t){"__proto__"in{}||t.extend(t.zepto,{Z:function(e,n){return e=e||[],t.extend(e,t.fn),e.selector=n||"",e.__Z=!0,e},isZ:function(e){return"array"===t.type(e)&&"__Z"in e}});try{getComputedStyle(void 0)}catch(n){var e=getComputedStyle;window.getComputedStyle=function(t){try{return e(t)}catch(n){return null}}}}(Zepto)}var p3$=Zepto,p3sdk={ready:!1,instances:[],create_instance:function(t){var e=p3sdk.instances.length,n={player_id:t.player_id,player_type:t.player_type,player_ready:!1,debug:t.debug,player:!1,instance_index:e,current_time:-1,track_player:function(){setInterval(function(){if(n.player_ready){m=n.player.position(),v=!1;try{v=n.player.video_id()}catch(t){}m!=n.current_time&&(n.current_time=m,n.event.trigger("player:progress",{m:m,video_id:v}))}else n.player_ready=!(!n.player||!n.player.play),n.player_ready&&n.event.trigger("player:ready",{})},333)},event:{trigger:function(t,i){setTimeout(function(){p3$(p3sdk.get(e)).trigger(t,i),n.debug&&console.dir(p3$.extend(i,{event_name:t}))},0)}}},i=setInterval(function(){try{n.player=new p3sdk.player_interface[t.player_type](t.player_id,n)}catch(e){throw"P3SDK Player Setup Error: "+e}clearInterval(i)},1e3);return this.instances.push(n),n},get:function(t){if("number"==typeof t&&this.instances[t])return this.instances[t];for(i in this.instances)if(this.instances[i].player_id==t)return this.instances[i];return!1},initialize_container:function(t){if(!p3$(t).attr("initialized")){var e={player_id:p3$(t).attr("player_id"),player_type:p3$(t).attr("player_type"),debug:p3$(t).hasClass("p3sdk-debug")},n=p3sdk.create_instance(e);n.track_player(),p3$(t).find(".p3sdk-interactive-transcript").each(function(){n.interactive_transcripts=n.interactive_transcripts||[],n.interactive_transcripts.push(new p3sdk.interactive_transcript(n,this))}),p3$(t).find(".p3sdk-playlist").each(function(){n.playlists=n.playlists||[],n.playlists.push(new p3sdk.playlist(n,this))}),p3$(t).find(".p3sdk-audio-description").each(function(){n.audio_description_modules=n.audio_description_modules||[],n.audio_description_modules.push(new p3sdk.audio_description(n,this))}),p3$(t).attr("initialized",!0)}},init:function(){p3$(".p3sdk-container").not("[initialized]").each(function(){p3sdk.initialize_container(this)})}};p3sdk.player_interface={viddler:function(t){if("undefined"==typeof window[t])throw"Could not find player with id "+t;if(!window[t].manager)throw"Viddler Javascript API unavailable.";this.playerInstance=window[t],this.play=function(){this.playerInstance.manager.play()},this.pause=function(){this.playerInstance.manager.pause()},this.seek=function(t){this.play(),this.playerInstance.manager.seekTo(t)},this.position=function(){return parseInt(this.playerInstance.manager.currentTime)},this.duration=function(){return this.playerInstance.manager.currentPrimaryTrack.mediaElements[0].duration},this.play_state=function(){return"PLAYING"==this.playerInstance.manager.status.toUpperCase()?"PLAYING":"PAUSED"},this.get_volume=function(){},this.set_volume=function(){}},html5:function(t){if(this.player_id=t,player=p3$("#"+this.player_id).get(0),4!=player.readyState)throw"Could not find player with id "+t;this.play=function(){player.play()},this.pause=function(){player.pause()},this.play_state=function(){return player.paused?"PAUSED":"PLAYING"},this.seek=function(t){player.play(),player.currentTime=t/1e3},this.position=function(){return 1e3*p3$("#"+this.player_id).get(0).currentTime},this.duration=function(){return parseInt(1e3*player.duration,10)},this.play_state=function(){return player.paused?"PAUSED":"PLAYING"},this.get_volume=function(){return player.volume},this.set_volume=function(t){player.volume=t}},youtube:function(t){if("undefined"==typeof YT||"undefined"==typeof YT.Player)throw"YouTube Player API is missing";if(!YT.loaded)throw"YouTube API is not loaded for your video";void 0===YT.get(t)?this.youtube_player=new YT.Player(t):this.youtube_player=YT.get(t),this.player_id=t,this.play=function(){this.youtube_player.playVideo()},this.pause=function(){this.youtube_player.pauseVideo()},this.seek=function(t){this.youtube_player.seekTo(t/1e3,!0)},this.position=function(){return parseInt(1e3*this.youtube_player.getCurrentTime()+.5)},this.duration=function(){return parseInt(1e3*this.youtube_player.getDuration()+.5)},this.play_video_id=function(t){this.youtube_player.loadVideoById(t)},this.video_id=function(){return this.youtube_player.getVideoData().video_id},this.play_video_id_at_time=function(t,e){this.youtube_player.loadVideoById({videoId:t,startSeconds:e/1e3})},this.play_state=function(){return 1===this.youtube_player.getPlayerState()?"PLAYING":"PAUSED"},this.get_volume=function(){return this.youtube_player.getVolume()/100},this.set_volume=function(t){this.youtube_player.setVolume(100*t)}},jw7:function(t){if(!jwplayer(t).play)throw"Could not find player with id "+t;this.playerInstance=jwplayer(t),this.play=function(){this.playerInstance.play(!0)},this.pause=function(){this.playerInstance.pause(!0)},this.seek=function(t){this.playerInstance.seek(parseInt(t/1e3))},this.position=function(){return parseInt(1e3*this.playerInstance.getPosition()+.5)},this.duration=function(){return 1e3*this.playerInstance.getDuration()},this.play_state=function(){return"playing"==this.playerInstance.getState()?"PLAYING":"PAUSED"},this.get_volume=function(){return this.playerInstance.getVolume()/100},this.set_volume=function(t){this.playerInstance.setVolume(100*t)}},wistia:function(t){if(!Wistia)throw"Could not find Wistia Javascript API";if(!Wistia&&Wistia.api(t))throw"Could not find Wistia player with id "+t;this.wistia=Wistia.api(t),this.play=function(){this.wistia.play()},this.pause=function(){this.wistia.pause()},this.seek=function(t){this.wistia.time(t/1e3),this.wistia.play()},this.position=function(){return parseInt(1e3*this.wistia.time()+.5)},this.duration=function(){return 1e3*this.wistia.duration()},this.play_video_id=function(t){this.wistia.replaceWith(t)},this.play_state=function(){return"playing"===this.wistia.state()?"PLAYING":"PAUSED"},this.get_volume=function(){return this.wistia.volume()},this.set_volume=function(t){this.wistia.volume(t)},this.ready=!0},wistia_iframe:function(t){if(!Wistia)throw"Could not find Wistia Javascript API";if(!Wistia&&Wistia.api(t))throw"Could not find Wistia player with id "+t;this.wistia_iframe=Wistia.api(t),this.play=function(){this.wistia_iframe.play()},this.pause=function(){this.wistia_iframe.pause()},this.seek=function(t){this.wistia_iframe.time(t/1e3),this.wistia_iframe.play()},this.position=function(){return parseInt(1e3*this.wistia_iframe.time()+.5)},this.duration=function(){return 1e3*this.wistia_iframe.duration()},this.play_video_id=function(){},this.play_state=function(){return"playing"===this.wistia.state()?"PLAYING":"PAUSED"},this.get_volume=function(){return player.volume()},this.set_volume=function(t){player.volume(t)}},kaltura:function(t){if(this.kaltura_player=p3$("#"+t).get(0),!this.kaltura_player||!this.kaltura_player.kBind)throw"Could not find player or Javascript API unavailable for id "+t;this.player_state="PAUSED",this.playhead_time=0,this.player_id=t,this.seek_to=!1,this.play_handler=function(){this.player_state="PLAYING"},this.pause_handler=function(){this.player_state="PAUSED"},this.playhead_handler=function(t){this.player_state="PLAYING",this.playhead_time=1e3*parseFloat(t)},this.kaltura_player.kBind("playerPlayed",function(t){p3sdk.get(t).player.play_handler()}),this.kaltura_player.kBind("playerProgress",function(t){p3sdk.get(t).player.play_handler()}),this.kaltura_player.kBind("playerPaused",function(t){p3sdk.get(t).player.pause_handler()}),this.kaltura_player.kBind("playerPlayEnd",function(t){p3sdk.get(t).player.pause_handler()}),this.play=function(){this.kaltura_player.sendNotification("doPlay")},this.pause=function(){this.kaltura_player.sendNotification("doPause")},this.seek=function(t){this.kaltura_player.sendNotification("doSeek",t/1e3),this.play()},this.position=function(){
return 1e3*this.kaltura_player.evaluate("{video.player.currentTime}")},this.duration=function(){return 1e3*this.kaltura_player.evaluate("{mediaProxy.entry.duration}")},this.video_id=function(){return this.kaltura_player.evaluate("{mediaProxy.entry.id}")},this.play_video_id=function(t){this.kaltura_player.sendNotification("changeMedia",{entryId:t,seekFromStart:1}),setTimeout(function(){parent.play()},10)},this.play_video_id_at_time=function(t,e){this.kaltura_player.sendNotification("changeMedia",{entryId:t,seekFromStart:e.toString()}),setTimeout(function(){parent.play()},10)},this.play_state=function(){return this.player_state},this.get_volume=function(){return this.kaltura_player.evaluate("{video.volume}")},this.set_volume=function(t){this.kaltura_player.sendNotification("changeVolume",t)}},soundcloud:function(t){var e=this;this.player_id=t;var n=p3$("#"+this.player_id).get(0);this.soundcloud_player=SC.Widget(n),this.soundcloud_player.bind("playProgress",function(t){e.player_position=t.currentPosition,e.player_state="PLAYING"}),this.soundcloud_player.bind("pause",function(t){e.player_position=t.currentPosition,e.player_state="PAUSED"}),this.soundcloud_player.bind("finish",function(t){e.player_position=t.currentPosition,e.player_state="PAUSED"}),this.play=function(){this.soundcloud_player.play()},this.pause=function(){this.soundcloud_player.pause()},this.seek=function(t){this.soundcloud_player.isPaused()&&this.soundcloud_player.play(),this.soundcloud_player.seekTo(t)},this.position=function(){return e.player_position?e.player_position:0},this.play_state=function(){return"PAUSED"},this.get_volume=function(){return player.getVolume()},this.set_volume=function(t){player.setVolume(t)}},videojs:function(t){if(!videojs)throw"Could not find Videojs API";if(!videojs(t))throw"Could not find player with id "+t;this.playerInstance=videojs(t),this.play=function(){this.playerInstance.play()},this.pause=function(){this.playerInstance.pause()},this.seek=function(t){this.playerInstance.currentTime(parseInt(t/1e3)),this.playerInstance.play()},this.position=function(){return parseInt(1e3*this.playerInstance.currentTime()+.5)},this.duration=function(){return 1e3*this.playerInstance.duration()},this.play_video_id=function(t){this.player.src(t)},this.video_id=function(){return 0},this.play_state=function(){return this.playerInstance.paused()?"PAUSED":"PLAYING"},this.get_volume=function(){return this.playerInstance.volume()},this.set_volume=function(t){this.playerInstance.volume(t)}},soundmanager2:function(t){if("undefined"==typeof soundManager)throw"SoundManager API unavailable";if(!soundManager.getSoundById(t))throw"Could not find player with id "+t;var e=this;this.player_id=t,this.playerInstance=function(){return soundManager.getSoundById(e.player_id)},this.play=function(){this.playerInstance().play(t)},this.pause=function(){this.playerInstance().pause(t)},this.seek=function(e){this.playerInstance().setPosition(e),this.playerInstance().play(t)},this.position=function(){return parseInt(this.playerInstance().position,10)},this.duration=function(){return this.playerInstance().duration},this.play_state=function(){return"PAUSED"},this.get_volume=function(){return player.volume/100},this.set_volume=function(t){player.setVolume(100*t)}},ooyala:function(t){if(!window[t])throw"Could not find player with id "+t;if(!window[t].play)throw"Ooyala Javascript API unavailable.";this.player_id=t,player=window[this.player_id],this.play=function(){player.playMovie()},this.pause=function(){player.pauseMovie()},this.seek=function(t){player.playMovie();var e=t/1e3;player.seek(e)},this.position=function(){return 1e3*player.getPlayheadTime()},this.duration=function(){return 1e3*player.getCurrentItem().time},this.video_id=function(){return player.getCurrentItemEmbedCode()},this.play_state=function(){return"playing"===player.getState()?"PLAYING":"PAUSED"},this.get_volume=function(){return player.getVolume()},this.set_volume=function(t){player.setVolume(t)}},ooyala_v4:function(t){if(!window[t])throw"Could not find player with id "+t;if(!window[t].play)throw"Ooyala Javascript API unavailable.";this.player_id=t,this.player=function(){return window[this.player_id]},this.play=function(){this.player().play()},this.pause=function(){this.player().pause()},this.seek=function(t){this.player().play();var e=t/1e3;this.player().seek(e)},this.position=function(){return 1e3*this.player().getPlayheadTime()},this.duration=function(){return 1e3*this.player().getDuration()},this.video_id=function(){return this.player().getEmbedCode()},this.play_state=function(){return this.player().isPlaying()?"PLAYING":"PAUSED"},this.get_volume=function(){return this.player().getVolume()},this.set_volume=function(t){this.player().setVolume(t)}},brightcove:function(t){var e=this;t=t;if(void 0===videojs(t))throw"Brightcove could not find player with id "+t;this.player=function(){return videojs(t)},this.play=function(){this.player().play()},this.pause=function(){this.player().pause()},this.seek=function(t){this.player().paused()&&this.player().play(),this.player().currentTime(t/1e3)},this.position=function(){return 1e3*this.player().currentTime()},this.duration=function(){return 1e3*this.player().duration()},this.video_id=function(){return this.player().mediainfo.id},this.play_video_id=function(t,n){this.player().catalog.getVideo(t,function(t,i){e.player().catalog.load(i),setTimeout(function(){e.seek(n||0)},1)})},this.play_video_id_at_time=function(t,n){e.play_video_id(t,n)},this.play_state=function(){return this.player().paused()?"PAUSED":"PLAYING"},this.get_volume=function(){return this.player().volume()},this.set_volume=function(t){this.player().volume(t)}},brightcove_legacy:function(t,e){var n=this;n.instance=e;var i=brightcove.getExperience(t),a=i.getModule(brightcove.api.modules.APIModules.VIDEO_PLAYER);i.getModule(APIModules.EXPERIENCE),i.getModule(APIModules.CONTENT);a.addEventListener(BCMediaEvent.PLAY,function(){}),a.addEventListener(BCMediaEvent.STOP,function(){}),a.addEventListener(BCMediaEvent.BEGIN,function(){}),a.addEventListener(BCMediaEvent.PROGRESS,function(t){n.player_info.position=parseInt(1e3*parseFloat(t.position),10)}),this.player_info={position:0},this.play=function(){a.play()},this.pause=function(){a.pause()},this.seek=function(t){a.play(),a.seek(t/1e3)},this.position=function(){return this.player_info.position},this.duration=function(){return 1e3*a.getVideoDuration()},this.play_state=function(){return a.isPlaying()?"PLAYING":"PAUSED"}},limelight:function(){this.play=function(){LimelightPlayer.doPlay()},this.pause=function(){LimelightPlayer.doPause()},this.seek=function(t){LimelightPlayer.doSeekToSecond(t/1e3)},this.position=function(){return LimelightPlayer.doGetPlayheadPositionInMilliseconds()},this.duration=function(){return LimelightPlayer.doGetCurrentMedia().durationInMilliseconds},this.play_video_id=function(t){this.play(),LimelightPlayer.doLoadMedia(t,!0,0)},this.play_state=function(){return!0===LimelightPlayer.doGetCurrentPlayState().isPlaying?"PLAYING":"PAUSED"},this.get_volume=function(){return LimelightPlayer.doGetVolume()},this.set_volume=function(t){LimelightPlayer.doSetVolume(t)}},vimeo_iframe:function(t,e){var n=this;if(n.instance=e,this.vimeo_player_id=t,"undefined"==typeof $f)throw"Could not find Vimeo Javascript API";if(this.vimeo_player=$f(t),!this.vimeo_player)throw"Could not find vimeo player with id "+t;this.playhead_time=0,this.player_state="PAUSED",this.duration=!1;var i={};PlayerInterfaceExtension_VimeoIframe=function(t){var e=this;this.player_interface=t,this.playhead_handler=function(t){e.player_interface.player_state="PLAYING",e.player_interface.playhead_time=1e3*parseFloat(t.seconds)}},i[t]=new PlayerInterfaceExtension_VimeoIframe(this),this.vimeo_player.addEvent("play",function(t){i[t].play_handler(t)}),this.vimeo_player.addEvent("onPause",function(t){i[t].pause_handler(t)}),this.vimeo_player.addEvent("onLoading",function(t){i[t].pause_handler(t)}),this.vimeo_player.addEvent("onFinish",function(t){i[t].pause_handler(t)}),this.vimeo_player.addEvent("playProgress",function(t,e){i[e].playhead_handler(t,e)}),this.play=function(){n.vimeo_player.api("play")},this.pause=function(){n.vimeo_player.api("pause")},this.position=function(){return this.playhead_time||0},this.seek=function(t){var e=Math.max(0,t/1e3-1);n.vimeo_player.api("seekTo",e)},this.duration=function(){if(n.vimeo_player.duration)return duration;n.vimeo_player.api("getDuration",function(){})},this.play_video_id=function(t){n.vimeo_player.api("loadVideo",t)},this.play_state=function(){return n.player_state}},flowplayer:function(t){if(!flowplayer().ready)throw"Flowplayer Javascript API is not ready or not available.";this.player_id=t,this.play=function(){flowplayer().play()},this.pause=function(){flowplayer().pause()},this.seek=function(t){flowplayer().seek(t/1e3),flowplayer().play()},this.position=function(){return 1e3*flowplayer().video.time},this.duration=function(){return 1e3*flowplayer().video.duration},this.play_video_id=function(t){flowplayer().load(t)},this.play_state=function(){return flowplayer().paused?"PAUSED":"PLAYING"},this.get_volume=function(){return flowplayer().volumeLevel},this.set_volume=function(t){flowplayer().volume(t)}},noplayer:function(){this.play=function(){return!0},this.pause=function(){return!0},this.seek=function(){return!0},this.position=function(){return 0},this.duration=function(){return 1},this.play_video_id=function(){return!1},this.video_id=function(){return!1},this.play_video_id_at_time=function(){return!1},this.play_state=function(){return"PAUSED"},this.get_volume=function(){return 1},this.set_volume=function(){return!0}},ableplayer:function(t){if(this.player_id=t,player=p3$("#"+this.player_id).get(0),4!=player.readyState)throw"Ableplayer with id "+this.player_id+" was not found or is not ready";this.play=function(){player.play()},this.pause=function(){player.pause()},this.seek=function(t){player.play(),player.currentTime=t/1e3},this.position=function(){return 1e3*p3$("#"+this.player_id).get(0).currentTime},this.duration=function(){return parseInt(1e3*player.duration,10)},this.play_state=function(){return player.paused?"PAUSED":"PLAYING"},this.get_volume=function(){return player.volume},this.set_volume=function(t){player.volume=t}},vimeo_v2:function(t){var e=this,n=document.getElementById(t);if(!Vimeo&&Vimeo.Player)throw"Vimeo Player API is not set up";var i=new Vimeo.Player(n);if(!i)throw"Vimeo API can not find player with ID: "+t;this.currentPosition=0,this.currentDuration=0,this.currentPlayState="PAUSED",i.on("progress",function(t){e.currentDuration=1e3*t.duration}),i.on("timeupdate",function(t){e.currentPosition=1e3*t.seconds,e.currentDuration=1e3*t.duration}),i.on("pause",function(){e.currentPlayState="PAUSED"}),i.on("play",function(){e.currentPlayState="PLAYING"}),i.on("ended",function(){e.currentPlayState="PAUSED"}),this.play=function(){i.play()},this.pause=function(){i.pause()},this.seek=function(t){i.setCurrentTime(t/1e3),this.play()},this.position=function(){return this.currentPosition},this.duration=function(){return this.currentDuration},this.play_state=function(){return this.currentPlayState},this.get_volume=function(){return i.getVolume()},this.set_volume=function(t){return i.setVolume(t)}},vidyard:function(t){var e=this;if(!Vidyard)throw"Could not find Videojs API";if(!new Vidyard.player(t).status)throw"Could not find player with id "+t;this.playerInstance=new Vidyard.player(t),this.playerInstance.on("pause",function(){e.currentPlayState="PAUSED"}),this.playerInstance.on("play",function(){e.currentPlayState="PLAYING"}),this.play=function(){this.playerInstance.play()},this.pause=function(){this.playerInstance.pause()},this.seek=function(t){this.playerInstance.seek(parseInt(t/1e3)),this.playerInstance.play()},this.position=function(){return parseInt(1e3*this.playerInstance.currentTime())},this.duration=function(){return 1e3*this.playerInstance.metadata.length_in_seconds},this.play_state=function(){return e.currentPlayState},this.get_volume=function(){return this.playerInstance.volume()},this.set_volume=function(t){this.playerInstance.setVolume(t)}},vidyard_responsive:function(t){var e=this;if(!VidyardV4)throw"Could not find Videojs V4 API";if(!VidyardV4.api.getPlayersByUUID(t)[0].status)throw"Could not find player with id "+t;this.playerInstance=VidyardV4.api.getPlayersByUUID(t)[0],this.playerInstance.on("pause",function(){e.currentPlayState="PAUSED"}),this.playerInstance.on("play",function(){e.currentPlayState="PLAYING"}),this.play=function(){this.playerInstance.play()},this.pause=function(){this.playerInstance.pause()},this.seek=function(t){this.playerInstance.seek(parseInt(t/1e3)),this.playerInstance.play()},this.position=function(){return parseInt(1e3*this.playerInstance.currentTime())},this.duration=function(){return 1e3*this.playerInstance.metadata.length_in_seconds},this.play_state=function(){return e.currentPlayState},this.get_volume=function(){return this.playerInstance.volume()},this.set_volume=function(t){this.playerInstance.setVolume(t)}}},p3sdk.debug=function(t){console&&console.log&&console.dir&&("string"==typeof t?console.log(t):console.dir(t))},p3sdk.util={stamp_to_ms:function(t){var e=(t=t.replace(/\,/g,".")).split(/\:/),n=parseFloat(e[e.length-1]),i=parseInt(e[e.length-2],10);return 1e3*(3600*(e.length>2?parseInt(e[e.length-3],10):0)+60*i+n)},ms_to_stamp:function(t){var e=parseInt(t)/1e3;return(parseInt(e/60)+":"+(e=(e%=60)<10?"0"+e:e)).replace(/\.\d*$/,"")},end_of_sentence:function(t){return/[\.\?\!]$/.test(t)},params:function(t){if(t=t||location.href,parts=t.replace(/\#.*$/,"").split("?"),params={},parts.length>1)for(i in pp=parts[1].split("&"),pp)p=pp[i].split("="),params[p[0]]=p[1];return params},selected_html:function(){try{var t;if(window.getSelection){if((t=window.getSelection()).getRangeAt)var e=t.getRangeAt(0);else(e=document.createRange()).setStart(t.anchorNode,t.anchorOffset),e.setEnd(t.focusNode,t.focusOffset);var n=e.cloneContents(),a=n.childNodes;for(i=0;i<a.length;i++)a[i].style&&(a[i].style.backgroundColor="#fff");var r=document.createElement("div");return r.appendChild(n),r.innerHTML}if(document.selection)return(t=document.selection.createRange()).htmlText}catch(s){}return!1},load_remote_script:function(t,e){var n=document.createElement("script");if(n.src=t,n.type="text/javascript",e){n.onload=n.onreadystatechange=function(){if("undefined"!=typeof n.readyState&&"complete"!=n.readyState&&"loaded"!=n.readyState)return!1;e()};var i=document.getElementsByTagName("script")[0];i.parentNode.insertBefore(n,i)}else p3$("script").get(0).parentNode.appendChild(n)},load_stemmer:function(){p3sdk.util.stemmer_loaded||(p3sdk.util.stemmer_loaded=!0,"undefined"==typeof Snowball&&p3sdk.util.load_remote_script("//p3.3playmedia.com/javascripts/vendor/Snowball.min.js"))}},p3sdk.api={base_path:(/http/.test(location.protocol)?location.protocol:"http:")+"//static.3playmedia.com/p/projects/",get:function(t,e,n){var i=/^http/.test(t)?t:this.base_path+t;i+="?"+p3$.param(e),p3$.get(i,n)},getJSON:function(t,e,n){var i=/^http/.test(t)?t:this.base_path+t;i+="?"+p3$.param(e),p3$.getJSON(i,n)},get_keywords_async:function(t,e,n){var i=t.project_id+"/files/"+t.file_id+"/keywords.js";t.use_video_id&&(e.usevideoid=1),this.get(i,e,n)},get_transcript_async:function(t,e,n){var i=e.format||"html",a=t.project_id+"/files/"+t.file_id+"/transcript."+i;if(t.use_video_id&&(e.usevideoid=1),t.use_caption_frames&&(e.use_caption_frames=1),t.stream_transcript){var r=0;try{r=t.plugin.current_m||0}catch(s){r=0}e.start=parseInt(Math.max(0,r-6e4),10),e.end=e.start+6e5,t.plugin.update_config("streaming_transcript_start",e.start),t.plugin.update_config("streaming_transcript_end",e.end)}getter="tpm"==i?"getJSON":"get",this[getter](a,e,n)},search_transcript_async:function(t,e,n){var i=t.project_id+"/files/"+t.file_id+"/segments/search.js";t.use_video_id&&(e.usevideoid=1),this.getJSON(i,e,n)},transcript_download_url:function(t,e){e=e||"html";var n=this.base_path;return n+=t.project_id+"/files/"+t.file_id+"/transcript."+e,n+="?dl=1",t.use_video_id&&(n+="&usevideoid=1"),n}},p3sdk.interactive_transcript=function(instance,el){var container=el,content_container=p3$(el).find(".p3sdk-interactive-transcript-content"),parent=this;this.instance=instance,this.container=container,this.module_index=instance.interactive_transcripts.length,this.fetching_transcript=!1,this.config=function(){var t={instance:parent.instance,instance_index:parent.instance.instance_index,module_index:parent.module_index,plugin:parent};parent.instance.player&&parent.instance.player_interface&&(t.player_interface=parent.player["interface"]);var e=p3$(container).get(0).attributes;for(i in e){var n=e[i].nodeValue;switch(n){case"true":n=!0;break;case"false":n=!1}"undefined"!=typeof e[i].nodeName&&(t[e[i].nodeName]=n)}return t},this.update_config=function(t,e){e="string"==typeof e?e:JSON.stringify(e),p3$(container).attr(t,e)},this.init=function(){this.listeners(),this.loaders(),this.captions_initializer(),parent.trigger_event("transcript:initialized",{})},this.trigger_event=function(t,e){e=p3$.extend(e||{},{module_index:parent.module_index,container_id:p3$(container).attr("id")}),parent.instance.event.trigger(t,e)},this.loaders=function(){if(window.location.hash){var t={};p3$.map(window.location.hash.replace(/^\#/,"").split("&"),function(e){x=e.split(":"),t[x[0]]=x[1]}),t.p3clip&&(parts=t.p3clip.split("."),parts[0]==parent.instance.instance_index&&parts[1]==parent.module_index&&(parent.onload_clip={in_time:parts[2],out_time:parts[3]},parts.length>=5&&(parent.onload_clip.video_id=parts[4])))}},this.captions_initializer=function(){var t=p3$("#p3sdk-captions-"+parent.instance.player_id).find(".p3sdk-captions-plugin-settings").attr("p3sdk-captions-overlay"),e=p3$("#p3sdk-captions-"+parent.instance.player_id).find(".p3sdk-captions-plugin-settings").attr("p3sdk-minimize-onload");if(t){parent.overlay_p3sdk_captions_plugin();var n=parent.instance.player_id||"video-stream";p3$("#p3sdk-captions-"+n).on("mouseenter mousemove",function(){p3$(".p3sdk-captions-button-layout").css({opacity:1})}),p3$("#p3sdk-captions-"+n).on("mouseleave",function(){p3$(".p3sdk-captions-button-layout").css({opacity:0})})}e&&parent.p3sdk_caption_minimizer()},this.listeners=function(){p3$(content_container).mouseenter(function(){parent.update_config("scroll_locked",!0)}).mouseleave(function(){parent.update_config("scroll_locked",!1)}),p3$(container).on("click",".p3sdk-scroll-toggle",function(){var t="p3sdk-scroll-toggle-locked";p3$(this).hasClass(t)?(p3$(this).removeClass(t),p3$(this).html(p3$(this).attr("label_when_unlocked")),parent.update_config("scroll_always_off",!0)):(p3$(this).addClass(t),p3$(this).html(p3$(this).attr("label_when_locked")),parent.update_config("scroll_always_off",!1))}),p3$(content_container).click(function(t){if(parent.config().disable_transcript_click)return!0;"span"==t.target.tagName.toLowerCase()&&parent.instance.player.seek(p3$(t.target).attr("m"))}),p3$(container).find(".p3sdk-interactive-transcript-searchbox").length>0&&p3sdk.util.load_stemmer(),parent.search_timeout=!1,p3$(container).on("keyup",".p3sdk-interactive-transcript-searchbox",function(t){if(clearTimeout(parent.search_timeout),27==(t.keyCode||t.which))return p3$(this).val(""),parent.clear_searched_transcript(),!0;var e=p3$(this).val();parent.search_timeout=setTimeout(function(){parent.search_transcript(e)},250)}),p3$(container).on("click",".p3sdk-interactive-transcript-download",function(){var t=p3$(this).attr("download_format"),e=p3sdk.api.transcript_download_url(parent.config(),t);location.href=e}),p3$(container).on("click",".p3sdk-interactive-transcript-progressbar",function(t){var e=(t.offsetX||t.layerX)/p3$(this).width()*parent.instance.player.duration();parent.instance.player.seek(e)}),p3$(container).on("click",".p3sdk-progress-search-marker",function(){parent.instance.player.seek(p3$(this).attr("m"))}),p3$(container).on("click",".p3sdk-interactive-transcript-collapse",function(){var t=p3$(container).children().not(".p3sdk-interactive-transcript-collapse, .p3sdk-interactive-transcript-collapse-visible");1==p3$(this).attr("collapsed")?(p3$(t).show(),p3$(this).attr("collapsed",0),p3$(this).html(p3$(this).attr("label_when_expanded")),parent.trigger_event("transcript:expand",{})):(p3$(t).hide(),p3$(this).attr("collapsed",1),p3$(this).html(p3$(this).attr("label_when_collapsed")),parent.trigger_event("transcript:collapse",{}))}),p3$(container).find(".p3sdk-collapse-onload").click(),p3$(container).on("change",".p3sdk-interactive-transcript-track-select",function(){parent.load_remote_track(p3$(this).val(),$(this).attr("src_type")),parent.trigger_event("transcript:track_selected",{target_element:this})}),p3$(container).on("click",".p3sdk-interactive-transcript-track",function(){parent.load_remote_track(p3$(this).attr("remote-src")),parent.trigger_event("transcript:track_selected",{target_element:this})}),p3$("#p3sdk-captions-"+parent.instance.player_id).on("click",".p3sdk-captions-minimizer",function(){parent.p3sdk_caption_minimizer()}),p3$("#p3sdk-captions-"+parent.instance.player_id).on("click",".p3sdk-captions-button-layout",function(){parent.p3sdk_caption_minimizer()}),p3$(container).on("click",".p3sdk-interactive-transcript-toggle-keywords",function(){p3$(this).prop("checked")?parent.load_keywords(this):parent.clear_keywords(this)}),p3$(container).on("click",".p3sdk-interactive-transcript-toggle-keywords-button",function(){var t="p3sdk-keywords-on";p3$(this).toggleClass(t),p3$(this).hasClass("p3sdk-keywords-on")?parent.load_keywords(this):parent.clear_keywords(this)}),p3$(container).on("mouseup",".p3sdk-interactive-transcript-content",function(){var t=p3sdk.util.selected_html();/\</.test(t)||""==t||(t=p3$(this).get(0).outerHTML);var e=p3$("<div>"+t+"</div>");if(e.find("span").length<(parent.config().clip_min_length||3))return!1;var n={in_time:parseInt(e.find("span").eq(0).attr("m"),10),out_time:parseInt(e.find("span").eq(-1).attr("m"),10),text:t.replace(/\<[^\>]+?\>/g,"").replace(/\s+/," "),elements:p3$(e).find("span")};parent.current_clip=n,parent.trigger_event("transcript:selection",n)}),p3$(container).on("click",".p3sdk-share",function(){var t="",e=location.href;switch(!0){case p3$(this).hasClass("p3sdk-facebook"):t="http://www.facebook.com/share.php?u="+encodeURIComponent(e)+"&t="+encodeURIComponent("Video Bookmark");break;case p3$(this).hasClass("p3sdk-twitter"):t="http://twitter.com/?status=Video Bookmark "+encodeURIComponent(e)+" #3playmedia"}t&&window.open(t)}),p3$(this.instance).bind("transcript:initialized",function(){parent.load_transcript()}),p3$(this.instance).bind("transcript:clear_search",function(){p3$(container).find(".p3sdk-progress-search-marker").remove()}),p3$(this.instance).bind("transcript:search",function(t,e){var n=p3$(".p3sdk-interactive-transcript-progressbar"),i=p3$(n).attr("search_result_marker");if(!i)return!1;var a=parent.instance.player.duration()||parseInt(p3$(content_container).find("span").last().attr("m"),10);p3$(n).css({position:"relative"}),p3$(e.matches).each(function(t,e){var r=e/a*100+"%",s=document.createElement("span");p3$(s).addClass("p3sdk-progress-search-marker"),p3$(s).html(i),p3$(s).attr("m",e),p3$(n).append(s),p3$(s).css({position:"absolute",left:r,zIndex:2e7,top:0})})}),p3$(this.instance).bind("player:progress",function(t,e){if(parent.config().stream_transcript){var n=parseInt(parent.config().streaming_transcript_start,0),i=parseInt(parent.config().streaming_transcript_end,0);(e.m<n-2e4||e.m>i-2e4)&&(parent.fetching_transcript||parent.load_transcript())}if(parent.config().platform_integration&&e.video_id!=parent.config().file_id&&(parent.update_config("file_id",e.video_id),parent.update_config("use_video_id",1),parent.load_transcript()),Math.abs(e.m-parent.current_m)>2e3&&parent.reset_transcript_tracking(),e.m!=parent.current_m&&(parent.track_word(e.m),parent.scroll_to_current_word(),parent.update_progress_bar(e.m),parent.current_m=e.m),(clip=parent.onload_clip)&&(clip.video_id?parent.instance.player.play_video_id_at_time(clip.video_id,clip.in_time):parent.instance.player.seek(clip.in_time),parent.onload_clip=!1,parent.clip_inTime=clip.in_time,parent.clip_outTime=clip.out_time,parent.trigger_event("transcript:clip_started",{inTime:parseInt(parent.clip_inTime,10),outTime:parseInt(parent.clip_outTime,10)})),parent.clip_outTime&&!parent.config().ignore_clip_end_times&&e.m>=parseInt(parent.clip_outTime,10)+350&&(parent.instance.player.pause(),parent.trigger_event("transcript:clip_ended",{inTime:parseInt(parent.clip_inTime,10),outTime:parseInt(parent.clip_outTime,10)}),parent.clip_outTime=!1),parent.config().progress_actions)try{obj=JSON.parse(parent.config().progress_actions),obj.search&&parent.instance.player.duration()&&(parent.load_search_term(obj.search),delete obj.search,parent.update_config("progress_actions",obj))}catch(a){}}),p3$(this.instance).bind("transcript:selection",function(t,e){if(parent.config().clip_urls){var n="p3clip:"+parent.instance.instance_index+"."+parent.module_index+"."+e.in_time+"."+e.out_time;parent.config().platform_integration&&(n+="."+parent.instance.player.video_id()),location.href=location.href.replace(/#.*/,"")+"#"+n}parent.current_clip_selection=e}),p3$(this.instance).bind("transcript:transcript_set",function(){p3$(".p3sdk-interactive-transcript-toggle-keywords:checked, p3sdk-keywords-on").each(function(){parent.load_keywords(this)}),p3$(".p3sdk-interactive-transcript-searchbox").val()&&parent.search_transcript(p3$(".p3sdk-interactive-transcript-searchbox").val())})},this.p3sdk_caption_minimizer=function(){p3$("#p3sdk-captions-"+parent.instance.player_id+" .p3sdk-captions-button-layout").toggle(),p3$("#p3sdk-captions-"+parent.instance.player_id+" .p3sdk-interactive-transcript").toggle()},this.overlay_p3sdk_captions_plugin=function(){var t=parent.instance.player_id||"video_stream",e=p3$("#"+t),n=p3$("#p3sdk-captions-"+t),i=(e.width(),n.width(),p3$(e).height()+p3$(e).offset().top);i-=n.height(),i-=40,p3$(n).css({position:"absolute",zIndex:1e8,top:i,opacity:"0.9"}),p3$(n).css({marginLeft:(p3$(e).width()-p3$(n).width())/2})},this.load_keywords=function(t){this.config().project_id&&this.config().file_id?p3sdk.api.get_keywords_async(this.config(),{},function(t){parent.highlight_keywords(JSON.parse(t))}):p3$(t).attr("remote-src")?p3$.get(p3$(t).attr("remote-src"),function(t){parent.highlight_keywords(JSON.parse(t))}):p3$(t).attr("keywords")&&parent.highlight_keywords(JSON.parse(p3$(t).attr("keywords")))},this.highlight_keywords=function(obj){var keyvals={},re_arr=[],space_repl="(\\<[^\\>]*?\\>)*\\s*(\\<[^\\>]*?\\>)*\\s*",dostem="undefined"!=typeof Snowball;p3$.each(obj,function(t){var e=obj[t][0].replace(/^\s+|\s+$/,"");if(restr=e.replace(/\s+/g,space_repl),dostem){parent.stemmer=parent.stemmer||new Snowball("English");var n=e.split(/\s+/),i=[];for(j=0;j<n.length;j++){parent.stemmer.setCurrent(n[j]),parent.stemmer.stem();var a=parent.stemmer.getCurrent();i.push(a)}sstr=i.join(space_repl),keyvals[i.join(" ")]=obj[t][1],sstr!=restr&&(restr+="|"+sstr)}/\s/.test(e)?re_arr.unshift(restr):re_arr.push(restr),keyvals[e.toLowerCase()]=obj[t][1]});var bigre=eval('/<span[^>]+id="([^"]+?)"[^>]*>('+re_arr.join("|")+")[\b.!?)\"']*</gi"),matches={},tre=/\<[^\>]*\>/g;p3$(content_container).find("p").each(function(){matches={};var t=p3$(this).html();p3$(this).find("span").first().attr("m");for(sid in t.replace(bigre,function(t,e,n){var i=n.replace(tre," ").replace(/\s+/g," ");matches[e]={s:i,v:keyvals[i.toLowerCase()]}}),matches)for(var e=p3$("#"+sid),n=matches[sid].s.split(/\s+/).length,i=0;i<n;i++){var a=140;matches[sid].v>150&&(a=matches[sid].v>165?233:185),p3$(e).css("font-size",a+"%"),p3$(e).addClass("p3sdk-transcript-keyword"),e=e.next()}}),parent.trigger_event("transcript:keywords_highlighted",{keywords:obj})},this.clear_keywords=function(){var t=p3$(content_container).find(".p3sdk-transcript-keyword");p3$(t).removeClass("p3sdk-transcript-keyword").css("font-size",""),parent.trigger_event("transcript:keywords_cleared",{})},this.cache_key=function(){return parent.instance.instance_index.toString()+parent.module_index.toString()},this.load_transcript=function(){if(1==parent.fetching_transcript)return!1;parent.config().embedded?parent.set_transcript(p3$(content_container).html()):parent.config().project_id&&parent.config().file_id?(this.fetching_transcript=!0,p3sdk.api.get_transcript_async(this.config(),{format:"tpm"},function(t){parent.fetching_transcript=!1,t.is_error?(parent.set_transcript("<p><span m='0'>No transcript</span></p>",{}),parent.trigger_event("transcript:transcript_not_found")):parent.set_transcript(t.transcript,t.file)})):p3$(container).attr("remote-src")&&("tpm"==parent.config().src_type?p3$.getJSON(p3$(container).attr("remote-src"),function(t){parent.set_transcript(t.transcript,t.file)}):p3$.get(p3$(container).attr("remote-src"),function(t){"custom"==parent.config().src_type&&(t=p3_interactive_transcript_custom_parser(t)),"srt"==parent.config().src_type&&(t=parent.srt_to_interactive(t)),parent.set_transcript(t)}))},this.load_remote_track=function(t,e){p3$.get(t,function(n){"srt"==e&&(n=parent.srt_to_interactive(n)),parent.set_transcript(n),parent.trigger_event("transcript:track_loaded",{track_url:t})})},this.set_transcript=function(t,e){p3$(content_container).html(t),p3$(content_container).find("p").each(function(){0==p3$(this).find("[m]").length&&p3$(this).remove()}),this.transcript_paragraphs=[],this.current_word=!1;var n=parent.cache_key();p3$(content_container).find("[m]").each(function(){var t=n+"_"+p3$(this).attr("m");p3$(this).attr("id",t)}),parent.trigger_event("transcript:transcript_set",e||{})},this.srt_to_interactive=function(t){var e=p3$.trim(t).split(/[\n\r]+/),n=[],a=0,r=[],s=!1;for(i=0;i<e.length;i++)line=e[i],Number(line)==a+1?((a+=1)>1&&r.push("</span>"),s&&(n.push(r),r=[],s=!1)):/\-\-\>/.test(line)?(start_time=p3$.trim(line.split("-->")[0]),r.push("<span m='"+p3sdk.util.stamp_to_ms(start_time)+"'>")):""!=line&&(r.push(line),s=p3sdk.util.end_of_sentence(line));for(i in r.length>0&&n.push(r),output=[],n)output.push("<p>"+n[i].join(" ")+"</p>");return output.join("")},this.reset_transcript_tracking=function(){var t=["p3sdk-tracked-paragraph","p3sdk-current-word","p3sdk-tracked-word"];p3$(content_container).find("."+t.join(", .")).removeClass(t.join(" ")),parent.current_word=!1,parent.current_paragraph=!1},this.current_word=!1,this.current_paragraph=!1,this.track_word=function(t){0==parent.transcript_paragraphs.length&&p3$(content_container).find("p").each(function(){parent.transcript_paragraphs.push(parseInt(p3$(this).find("[m]").first().attr("m"),10))}),current_p_index=!1,p3$(parent.transcript_paragraphs).each(function(e,n){if(n>t)return current_p_index=Math.max(0,e-1),!1;p3$(p3$(content_container).find("p")[e]).addClass("p3sdk-tracked-paragraph")}),!1===current_p_index&&(current_p_index=parent.transcript_paragraphs.length-1);var e=!1,n=p3$(p3$(content_container).find("p")[current_p_index]);n.removeClass("p3sdk-tracked-paragraph");var a=n.find("span");if(p3$(a).each(function(){if(t<parseInt(p3$(this).attr("m"),10))return e=p3$(this),e=p3$(e).prev().length>0?p3$(e).prev():e,!1;p3$(this).addClass("p3sdk-tracked-word")}),e||(current_p_index==parent.transcript_paragraphs.length-1?e=p3$(a).last():(lw=p3$(a).last(),fw=p3$(p3$(content_container).find("p")[current_p_index+1]).find("span")[0],e=Math.abs(parseInt(p3$(lw).attr("m"),10)-t)<Math.abs(parseInt(p3$(fw).attr("m"),10)-t)?p3$(lw):p3$(fw))),parent.current_word&&parent.transcript_paragraphs[current_p_index]==parent.current_paragraph&&p3$(parent.current_word).last()[0]!=p3$(e).prev()[0]&&parseInt(p3$(e).prev().attr("m"))>parseInt(p3$(parent.current_word).last().attr("m")))for(skipped_words=parent.find_words_between_highlighted(p3$(parent.current_word),p3$(e).prev()),i=0;i<skipped_words.length;i++)p3$(e).push(skipped_words[i][0]);parent.current_word&&p3$(parent.current_word).removeClass("p3sdk-current-word"),parent.current_word=e,parent.current_paragraph=parent.transcript_paragraphs[current_p_index],p3$(parent.current_word).removeClass("p3sdk-tracked-word").addClass("p3sdk-current-word"),parent.trigger_event("transcript:current_word",{m:t,current_word:parent.current_word})},this.find_words_between_highlighted=function(t,e){for(var n=[];t[0]!=e[0];)t=t.next(),n.push(t);return n},this.scroll_to_current_word=function(t){if((this.config().scroll_locked||this.config().scroll_always_off)&&!t)return!1;var e=this.current_word,n=p3$(content_container).find("span[m]").first(),i=p3$(content_container).scrollTop(),a=p3$(e).offset().top-p3$(n).offset().top
;parent.config().light_scroll?(a-i>.75*p3$(content_container).height()||a-i<0)&&p3$(content_container).scrollTop(a):a!=this.current_scroll&&(this.current_scroll=a,p3$(content_container).scrollTop(a))},this.play_clip=function(t){parent.instance.player.seek(t.in_time)},this.update_progress_bar=function(t){p3$(container).find(".p3sdk-interactive-transcript-progress").each(function(){var e=t/parent.instance.player.duration()*100;p3$(this).css("width",e+"%")})},this.clear_searched_transcript=function(){p3$(content_container).find(".p3sdk-interactive-transcript-search-hit").removeClass("p3sdk-interactive-transcript-search-hit"),parent.trigger_event("transcript:clear_search")},this.load_search_term=function(t){p3$(".p3sdk-interactive-transcript-searchbox").val(t),this.search_transcript(obj.search)},this.search_streamed_transcript=function(t){p3sdk.api.search_transcript_async(this.config(),{query:t},function(e){matches=p3$.map(e.segments,function(t){return parseInt(t.fields.timestamp,10)}),parent.trigger_event("transcript:search",{searchterm:t,matches:matches})})},this.search_transcript=function(t,e){this.clear_searched_transcript(),t=t.replace(/\"([^\s\"]+?)\"$/g,"$1");var n=/\".+\"/;n.test(t)||(t=t.replace(/\"/g,""));var i=p3$.trim(t).split(/\s+/);return parent.saved_search_term=i.join("|"),""!=i.join("")&&(n.test(t)||(parent.stemmer=parent.stemmer||new Snowball("English"),p3$.each(i,function(t,e){parent.stemmer.setCurrent(e),parent.stemmer.stem();var n=parent.stemmer.getCurrent();p3$.inArray(n,i)<0&&i.push(n)})),matches=parent.phrase_search_matches(i),e&&parent[e](matches),parent.config().stream_transcript?parent.search_streamed_transcript(t):void parent.trigger_event("transcript:search",{searchterm:t,matches:matches}))},this.phrase_search_matches=function(sanitized_arr){var search_phrases=[],quoted=!1,open_quote=/^\"/,close_quote=/\"$/;phrasewords=[],p3$(sanitized_arr).each(function(t,e){quoted?close_quote.test(e)?(quoted=!1,e=e.replace(/\"$/,""),phrasewords.push(e),search_phrases.push(phrasewords.join(" ")),phrasewords=[]):phrasewords.push(e):open_quote.test(e)?(quoted=!0,e=e.replace(/^\"/,""),phrasewords=[e]):search_phrases.push(e)}),matches=[],matched_spans=[];var m_finder=/m\=\"(\d+)\"/gi,ck=parent.cache_key();return p3$(search_phrases).each(function(i,phrase){phrase=phrase.replace(/\s+/g,"(<[^>]+>|\\s)*"),phrase=/[A-Za-z]/.test(phrase)?"(<[^>/]+>)[^<]*?\\b"+phrase:"(<[^>/]+>)[^<]*?"+phrase;var re=eval("/("+phrase+")/gi");p3$(content_container).html().replace(re,function(t){t.replace(m_finder,function(){var t=parseInt(arguments[1],10);matches.push(t),p3$("#"+ck+"_"+t).addClass("p3sdk-interactive-transcript-search-hit")})})}),matches},this.init()},p3sdk.playlist=function(e,n){var r=n,s=this;this.results_container=p3$(n).find(".p3sdk-playlist-dynamic-list"),this.result_template=p3$(n).find(".p3sdk-playlist-dynamic-list-template").html(),this.no_results_template=p3$(n).find(".p3sdk-playlist-dynamic-list-no-results-template").html()||"No results",this.pagination_container=p3$(n).find(".p3sdk-playlist-dynamic-pagination"),this.pagination_template="<a href='javascript:void(0)' class='p3sdk-playlist-pagination-link' page='{page}' per_page='{per_page}' query='{query}'>{display_text}</a>",this.instance=e,this.module_index=e.playlists.length,this.init=function(){p3$(r).on("click",".p3sdk-playlist-play-video-id",function(){vid=p3$(this).attr("video_id"),s.instance.player.play_video_id(vid),s.trigger_event("playlist:video_played",{video_id:vid}),p3$(s.instance.interactive_transcripts).each(function(t,e){p3$(e.container).find(".p3sdk-interactive-transcript-searchbox").val(""),e.clear_searched_transcript()})}),p3$(r).on("click",".p3sdk-playlist-result-timeline",function(t){vid=p3$(this).attr("video_id"),duration=p3$(this).attr("duration"),percent=(t.pageX-p3$(this).offset().left)/p3$(this).offset().width,s.instance.player.play_video_id_at_time(vid,duration*percent),s.trigger_event("playlist:video_played",{video_id:vid}),p3$(s.instance.interactive_transcripts).each(function(t,e){e.update_config("progress_actions",{search:s.config().last_query})})}),p3$(r).on("click",".p3sdk-playlist-submit-search",function(){var t=p3$(r).find(".p3sdk-playlist-searchbox").val();s.search_files({query:t})}),p3$(r).on("keyup",".p3sdk-playlist-searchbox",function(t){switch(t.keyCode||t.which){case 13:s.search_files({query:p3$(this).val()});break;case 27:p3$(this).val(""),s.search_files()}}),p3$(r).on("click",".p3sdk-playlist-reset-search",function(){p3$(r).find(".p3sdk-playlist-searchbox").first().val(""),s.search_files("")}),p3$(r).on("click",".p3sdk-playlist-search-link",function(){p3$(r).find(".p3sdk-playlist-searchbox").first().val(p3$(this).html()),s.search_files({query:p3$(this).html()})}),p3$(r).on("change",".p3sdk-playlist-tag-selector",function(){t=p3$(this).val(),s.update_config("tags",t),s.trigger_event("playlist:tag_selected",{tag:t}),s.search_files({query:p3$(r).find(".p3sdk-playlist-searchbox").val()})}),p3$(r).on("click",".p3sdk-playlist-tag-list input[type=checkbox]",function(){tags=p3$(".p3sdk-playlist-tag-list :checked").pluck("value"),s.update_config("tags",tags.join(", ")),s.search_files({query:p3$(r).find(".p3sdk-playlist-searchbox").val()})}),p3$(r).on("click",".p3sdk-playlist-pagination-link",function(){var t={page:p3$(this).attr("page"),per_page:p3$(this).attr("per_page"),query:p3$(this).attr("query")};s.search_files(t)}),p3$(this.instance).bind("player:progress",function(){vid=s.instance.player.video_id(),p3$(r).find(".p3sdk-playlist-current-video").removeClass("p3sdk-playlist-current-video"),p3$(r).find("[video_id='"+vid+"']").addClass("p3sdk-playlist-current-video")}),this.search_files()},this.trigger_event=function(t,e){e=p3$.extend(e||{},{module_index:s.module_index,container_id:p3$(r).attr("id")}),s.instance.event.trigger(t,e)},this.config=function(){var t={},e=p3$(r).get(0).attributes;for(i in e){var n=e[i].nodeValue;switch(n){case"true":n=!0;break;case"false":n=!1}"undefined"!=typeof e[i].nodeName&&(t[e[i].nodeName]=n)}return t},this.update_config=function(t,e){p3$(r).attr(t,e)},this.search_url=function(t){return this.config().search_url?this.config().search_url:(this.config().vpi_id?url=this.config().project_id+"/video_platform_integrations/"+this.config().vpi_id+"/":url=this.config().project_id+"/linked_accounts/"+this.config().linked_account_id+"/",url+=t.query?"segmentmap.js":"playlist.js",url)},this.search_files=function(t){t=t||{};var e=s.search_url(t);t.page=t.page||1,t.per_page=t.per_page||this.config().per_page||6,tags=p3$.trim(t.tags||this.config().tags||""),tags&&(t.tags=tags.split(/\s*\,\s*/)),this.config().folder_id&&(t.batch_id=this.config().folder_id.split(/\s*\,\s*/)),this.config().sortby&&!t.query&&(t.sortby=this.config().sortby.replace(/\:.*$/,""),t.desc=/\:desc$/i.test(this.config().sortby)?1:0),s.update_config("last_query",t.query),p3sdk.api.getJSON(e,t,function(t){s.render_data(t)}),s.trigger_event("playlist:search",t)},this.render_data=function(t){for(this.render_pagination(t),p3$(s.results_container).html(""),files=t.files,i=0;i<files.length;i++)res=s.result_template.replace(/{name}/g,files[i].name).replace(/{duration}/g,p3sdk.util.ms_to_stamp(files[i].duration)).replace(/{attribute1}/g,files[i].attribute1).replace(/{attribute2}/g,files[i].attribute2).replace(/{attribute3}/g,files[i].attribute3).replace(/{thumbnail_full}/g,"<img src='"+(files[i].thumbnail_url||"")+"' width=100% height=100%>").replace(/{thumbnail\_(\d+)x(\d+)}/g,"<img src='"+(files[i].thumbnail_url||"")+"' width=$1px height=$2px>").replace(/{video_id}/g,files[i].video_id).replace(/{id}/g,files[i].id).replace(/{hit_count}/g,files[i].segmentmap?files[i].segmentmap.hits.length+(1==files[i].segmentmap.hits.length?" hit":" hits"):"").replace(/{result_timeline\_([\d\%]+)x(\d+)}/g,function(t,e,n){return files[i].segmentmap?s.render_result_timeline(files[i],e,n):""}),p3$(s.results_container).append(res);if(0==files.length){var e=s.no_results_template;p3$(s.results_container).html(e)}s.trigger_event("playlist:search_results",t)},this.render_result_timeline=function(t,e,n){var i=p3$("<div></div>");return i.addClass("p3sdk-playlist-result-timeline"),i.attr("duration",t.duration),i.attr("video_id",t.video_id),i.css({position:"relative",display:"block",width:/\%/.test(e)?e:e+"px",height:n+"px"}),p3$.each(t.segmentmap.hits,function(e){var a=t.segmentmap.hits[e],r=p3$("<div></div>");r.addClass("p3sdk-playlist-result-timeline-match"),r.attr("timestamp",a.timestamp),r.attr("duration",a.timestamp+a.length),r.attr("video_id",t.video_id),r.attr("file_id",t.file_id),r.css({marginLeft:100*a.timestamp/t.duration+"%",position:"absolute",zIndex:1e3+e,width:Math.ceil(100*a.length/t.duration)+"%",display:"block",height:n+"px"}),i.append(r)}),i.prop("outerHTML")},this.render_pagination=function(t){for(p3$(s.pagination_container).html(""),summary=t.summary,null!=p3$(this.pagination_container).attr("first")&&(a=this.create_pagination_link(1,summary.per_page,summary.query,p3$(this.pagination_container).attr("first")||"&lt;&lt;"),p3$(s.pagination_container).append(a)),null!=p3$(this.pagination_container).attr("prev")&&(a=this.create_pagination_link(Math.max(1,summary.current_page-1),summary.per_page,summary.query,p3$(this.pagination_container).attr("prev")||"&lt;"),p3$(s.pagination_container).append(a)),null!=p3$(this.pagination_container).attr("limit")?(limit=parseInt(p3$(this.pagination_container).attr("limit")),x=Math.max(1,summary.current_page-Math.floor(limit/2)),x=Math.min(x,summary.total_pages-limit+1),y=Math.max(x,1)+limit-1,y=Math.min(y,summary.total_pages),x=y-limit+1,x=Math.max(1,x)):(x=1,y=summary.total_pages),i=x;i<=y;i++)a=p3$(this.create_pagination_link(i,summary.per_page,summary.query)),i==summary.current_page&&p3$(a).addClass("p3sdk-playlist-current-page"),p3$(s.pagination_container).append(a);null!=p3$(this.pagination_container).attr("next")&&(a=this.create_pagination_link(Math.min(summary.current_page+1,summary.total_pages),summary.per_page,summary.query,p3$(this.pagination_container).attr("next")||"&gt;"),p3$(s.pagination_container).append(a)),null!=p3$(this.pagination_container).attr("last")&&(a=this.create_pagination_link(summary.total_pages,summary.per_page,summary.query,p3$(this.pagination_container).attr("last")||"&gt;&gt;"),p3$(s.pagination_container).append(a))},this.create_pagination_link=function(t,e,n,i){return s.pagination_template.replace(/{page}/g,t).replace(/{per_page}/g,e).replace(/{query}/g,n||"").replace(/{display_text}/g,i||t)},this.init()},p3sdk.audio_description=function(t,e){var n=e,i=this;this.p3sdk_instance=t,this["debugger"]=null,this.descPlayer=null,this.snipHandler=null,this.sourcePlayer=null,this.sourceHandler=null,this.status={interval:250,heartbeat:null,snippets:[],actionTimeout:null,pausedForSnip:!1,currentSnippet:null,lastEvent:null,nextAction:null,player_ready:!1},this.settings={equalizer_on:null,user_control_equalizer:null,default_autoplay:null},this.init=function(){this["debugger"]=new p3sdk.ad_debugger(e,i),this.descPlayer=new p3sdk.description_player(e,i),this.snipHandler=new p3sdk.snip_handler(e,i),p3$(i.p3sdk_instance).bind("player:ready",function(){i.initialize(),i.sourcePlayer=i.p3sdk_instance.player,i.status.player_ready=!0,"vimeo_v2"==i.p3sdk_instance.player_type?i.sourceHandler=new p3sdk.source_handler_promise(i):i.sourceHandler=new p3sdk.source_handler(i),p3$(n).find(".mycroft-loading").hide()}),i.listen()},this.initialize=function(){var t=p3$(n).attr("p3sdk-snippets"),e=p3$(n).attr("p3sdk-equalize-on"),i=p3$(n).attr("p3sdk-user-control-equalizer"),a=p3$(n).attr("p3sdk-default-autoplay");t&&(snippets=JSON.parse(t),this.status.snippets=snippets),e&&(this.settings.equalizer_on=p3$(n).attr("p3sdk-equalize-on")),i&&(this.settings.user_control_equalizer=p3$(n).attr("p3sdk-user-control-equalizer")),a&&(this.settings.default_autoplay=p3$(n).attr("p3sdk-default-autoplay"))},this.listen=function(){!1===i.status.player_ready?setTimeout(function(){i.listen()},250):(i.settings.default_autoplay&&i.toggleEnabled(!0),p3$(n).on("click keydown",".mycroft-audio-description-toggle",function(t){"click"===t.type&&i.descPlayer.toggleMute()}),p3$(n).on("click keydown",".mycroft-equalizer-toggle",function(t){"click"===t.type&&i.toggleEqualizer()}),p3$(n).on("click keydown",".mycroft-audio-description-snippet-toggle",function(t){"click"===t.type&&i.toggleEnabled()}),p3$(n).on("change input",".mycroft-vol-control",function(){i.descPlayer.setVolume(this.value)}))},this.toggleEnabled=function(t){var e="true"===p3$(n).find(".mycroft-audio-description-widget").attr("ad-enabled");t||!e?i.enable():i.disable()},this.enable=function(){p3$(n).find(".mycroft-audio-description-widget").attr("ad-enabled",!0),p3$(n).find(".mycroft-audio-description-snippet-toggle").attr("aria-pressed",!0),p3$(n).find(".mycroft-audio-description-snippet-toggle").attr("aria-expanded",!0),p3$(n).find(".mycroft-audio-description-toggle").show(),this.settings.user_control_equalizer&&(this.settings.equalizer_on||i.disableEqualizer(),p3$(n).find(".mycroft-equalizer-toggle").show()),p3$(n).find(".mycroft-vol-control").show(),this.snipHandler.syncSnippetStates(),this.snipHandler.checkState()},this.disable=function(){this.snipHandler.stop(),p3$(n).find(".mycroft-audio-description-widget").attr("ad-enabled",!1),p3$(n).find(".mycroft-audio-description-snippet-toggle").attr("aria-pressed",!1),p3$(n).find(".mycroft-audio-description-snippet-toggle").attr("aria-expanded",!1),p3$(n).find(".mycroft-audio-description-toggle").hide(),this.settings.user_control_equalizer&&p3$(n).find(".mycroft-equalizer-toggle").hide(),p3$(n).find(".mycroft-vol-control").hide()},this.toggleEqualizer=function(){i.settings.equalizer_on?i.disableEqualizer():i.enableEqualizer()},this.enableEqualizer=function(){this.settings.equalizer_on=!0,p3$(n).find(".mycroft-equalizer-toggle").attr("aria-pressed",!0),p3$(n).find(".mycroft-equalizer-display").removeClass("mycroft-secondary"),p3$(n).find(".mycroft-equalizer-display").addClass("mycroft-primary")},this.disableEqualizer=function(){this.settings.equalizer_on=!1,p3$(n).find(".mycroft-equalizer-toggle").attr("aria-pressed",!1),p3$(n).find(".mycroft-equalizer-display").removeClass("mycroft-primary"),p3$(n).find(".mycroft-equalizer-display").addClass("mycroft-secondary")},this.init()},p3sdk.ad_debugger=function(t,e){var n=this;this.p3sdk_ad=e,this.debugging=!1,this.init=function(){if(p3$(t).hasClass("p3sdk-ad-debug")&&(n.debugging=!0),!n.debugging)return!1;n.make()},this.log=function(t){if(n.debugging&&console&&console.log){var e=new Date;console.log(e.toISOString().split("T")[1].split(".")[0]+" >>",t)}},this.make=function(){var t=document.createElement("table"),e=document.createElement("tbody");p3$(t).append(e),p3$(e).append("<tr><td>Next Action</td><td class=next-action></td>"),p3$(e).append("<tr><td>Next Time</td><td class=next-action-time></td></tr>"),p3$(e).append("<tr><td>Last Action</td><td class=last-action></td>"),p3$(e).append("<tr><td>Last Time</td><td class=last-action-time></td></tr>"),p3$(e).append("<tr><td>Source Time</td><td class=source-time></td></tr>"),p3$(e).append("<tr><td>Snip readyState</td><td class=ad-player-readyState></td></tr>"),p3$(e).append("<tr><td>Snip State</td><td class=snip-state></td></tr>"),p3$(e).append("<tr><td>Snip time</td><td class=snip-time></td></tr>"),p3$(e).append("<tr><td>Snip Player State</td><td class=ad-player-state></td></tr>"),p3$(e).append("<tr><td>Source State</td><td class=source-state></td></tr>"),p3$(e).append("<tr><td>Pause fo Snip</td><td class=pause-fo-snip></td></tr>"),p3$(document.body).append(t),p3$("table").addClass("p3sdk-debug-table"),setInterval(function(){var t=n.p3sdk_ad.sourcePlayer.play_state(),e=n.p3sdk_ad.sourcePlayer.position(),i=n.p3sdk_ad.snipHandler.findNextAction(e),a=i?p3sdk.util.ms_to_stamp(i.t_minus)+" ("+i.t_minus+")":"-",r=n.p3sdk_ad.status.lastEvent,s=r?r.time:"-";p3$(".next-action").html(i?i.action:"-"),p3$(".next-action-time").html(a),p3$(".last-action").html(r?r.type:"-"),p3$(".last-action-time").html(s),p3$(".source-state").html(t),p3$(".source-time").html(p3sdk.util.ms_to_stamp(e)),p3$(".snip-state").html(n.p3sdk_ad.status.currentSnippet&&n.p3sdk_ad.status.currentSnippet.state),p3$(".ad-player-readyState").html(n.p3sdk_ad.descPlayer.readyState()),p3$(".snip-time").html(n.p3sdk_ad.status.currentSnippet&&n.p3sdk_ad.status.currentSnippet.start_time),p3$(".ad-player-state").html(n.p3sdk_ad.descPlayer.state()),p3$(".pause-fo-snip").html(n.p3sdk_ad.status.pausedForSnip?"YAS":"NAAAAA")},200)},this.show=function(){p3$(".p3sdk-debug-table").show()},this.hide=function(){p3$(".p3sdk-debug-table").hide()},this.toggle=function(){n.debugging=!n.debugging,n.debugging?this.hide():this.show()},this.init()},p3sdk.description_player=function(t,e){var n=t,i=this;this.p3sdk_ad=e,this.muted_volume=null,this.seekTo=null,this.getPlayer=function(){return p3$(n).find(".mycroft-audio-track")[0]},this.toggleMute=function(){var t="true"===p3$(n).find(".mycroft-audio-description-toggle").attr("aria-pressed");p3$(n).find(".mycroft-audio-description-toggle").attr("aria-pressed",!t),i.getPlayer().muted?i.unmute():i.mute()},this.mute=function(){p3$(n).find(".mycroft-volume-display").removeClass("mycroft-primary p3sdk-fa-volume-up"),p3$(n).find(".mycroft-volume-display").addClass("mycroft-secondary p3sdk-fa-volume-off"),i.muted_volume=p3$(n).find(".mycroft-vol-control").val(),p3$(n).find(".mycroft-vol-control").val(0),i.getPlayer().muted=!0,p3$(n).find(".mycroft-audio-description-toggle").addClass("mycroft-muted")},this.unmute=function(){p3$(n).find(".mycroft-volume-display").removeClass("mycroft-secondary p3sdk-fa-volume-off"),p3$(n).find(".mycroft-volume-display").addClass("mycroft-primary p3sdk-fa-volume-up"),i.getPlayer().muted=!1,p3$(n).find(".mycroft-vol-control").val(i.muted_volume),p3$(n).find(".mycroft-audio-description-toggle").removeClass("mycroft-muted")},this.onPlayReady=function(){this.p3sdk_ad["debugger"].log("Play ready triggered!"),this.p3sdk_ad.snipHandler.playSnippet(this.p3sdk_ad.currentSnippet)},this.onLoaded=function(){this.p3sdk_ad.status.currentSnippet.state="loaded",this.p3sdk_ad.snipHandler.checkState()},this.play=function(){i.seekTo&&(i.seek(i.seekTo),i.seekTo=null),i.getPlayer().play()},this.pause=function(){i.getPlayer().pause()},this.setVolume=function(t){i.getPlayer().volume=t/100},this.seek=function(t){i.getPlayer().currentTime=t/1e3},this.paused=function(){return i.getPlayer().paused},this.playing=function(){return!i.paused()},this.state=function(){return i.paused()?"Paused":"Playing"},this.readyState=function(){return i.getPlayer().readyState},this.muted=function(){return i.getPlayer().muted},this.position=function(){return Math.round(1e3*i.getPlayer().currentTime)},this.snippetPosition=function(t){return i.position()-(t.start_time+t.delay)}},p3sdk.snip_handler=function(t,e){var n=this;this.p3sdk_ad=e,this.checkState=function(t){this.setupHeartbeat();var e=this.p3sdk_ad.sourcePlayer.play_state(),n=this.p3sdk_ad.sourcePlayer.position();t&&this.sourceHasSeeked(n,t)?this.seekActions(n):this.sourceHasResumed(e)&&this.resumeActions(n),this.userPausedSource(e,n)?this.pauseActions(n):this.setupNextAction(n)},this.findNextAction=function(t){for(var e=0;e<n.p3sdk_ad.status.snippets.length;e++){var i=n.p3sdk_ad.status.snippets[e];if("playing"==i.state)return!n.p3sdk_ad.status.pausedForSnip&&n.snippetHasPuase(i)?{action:"pause_source",t_minus:i.end_time-t,snippet:i}:!n.p3sdk_ad.status.pausedForSnip&&n.playersOutOfSync()?{action:"delay_source",t_minus:i.end_time-t,snippet:i}:{action:"end_snip",t_minus:i.audio_duration-n.p3sdk_ad.descPlayer.snippetPosition(i),snippet:i};if("paused"==i.state)return{action:"play_snip",t_minus:i.start_time-t,snippet:i}}},this.playersOutOfSync=function(){var t=this.p3sdk_ad.sourcePlayer.play_state(),e=this.p3sdk_ad.sourcePlayer.position(),n=this.p3sdk_ad.descPlayer.state(),i=this.p3sdk_ad.descPlayer.position(),a=this.p3sdk_ad.status.currentSnippet;return a&&"PLAYING"===t&&"Playing"===n&&Math.abs(e+a.delay-i)>250},this.snippetHasPuase=function(t){return t.end_time-t.start_time<t.audio_duration},this.snipEndsBeforeSource=function(t){return t.start_time+t.audio_duration<this.p3sdk_ad.sourcePlayer.duration()},this.shouldResumeSource=function(t){return n.p3sdk_ad.status.pausedForSnip&&n.snipEndsBeforeSource(t)},this.shouldPerformSnipAction=function(t){return"PLAYING"===this.p3sdk_ad.sourcePlayer.play_state()||t.start_time>=this.p3sdk_ad.sourcePlayer.duration()},this.userPausedSource=function(t,e){return t||(t=this.p3sdk_ad.sourcePlayer.play_state()),e||(e=this.p3sdk_ad.sourcePlayer.position()),!this.expectPause()&&("PAUSED"===t&&!this.p3sdk_ad.status.pausedForSnip&&e>0&&e<this.p3sdk_ad.sourcePlayer.duration())},this.expectPause=function(){return this.p3sdk_ad.status.lastEvent&&("seek"===this.p3sdk_ad.status.lastEvent.type||"pause_for_snip"===this.p3sdk_ad.status.lastEvent.type||"resume_source"===this.p3sdk_ad.status.lastEvent.type)&&Date.now()-this.p3sdk_ad.status.lastEvent.time<500},this.sourceHasSeeked=function(t,e){return Math.abs(t-e)>8*this.p3sdk_ad.status.interval},this.sourceHasResumed=function(t){return!(this.p3sdk_ad.status.lastEvent&&"pause_for_snip"===this.p3sdk_ad.status.lastEvent.type&&Date.now()-this.p3sdk_ad.status.lastEvent.time<500)&&(!(this.p3sdk_ad.status.lastEvent&&"user_pause"===this.p3sdk_ad.status.lastEvent.type&&Date.now()-this.p3sdk_ad.status.lastEvent.time<500)&&("PLAYING"===t&&(this.p3sdk_ad.status.pausedForSnip||this.p3sdk_ad.status.lastEvent&&"user_pause"===this.p3sdk_ad.status.lastEvent.type)))},this.stop=function(){this.p3sdk_ad["debugger"].log("STOP!"),this.clearHeartbeat(),this.clearActionTimeout(),this.removeCanPlayListeners(),this.pauseSnippet(),this.p3sdk_ad.status.pausedForSnip=!1,this.syncSnippetStates()},this.clearHeartbeat=function(){this.p3sdk_ad.status.heartbeat&&clearTimeout(n.p3sdk_ad.status.heartbeat),this.p3sdk_ad.status.heartbeat=null},this.setupHeartbeat=function(t){this.clearHeartbeat();var e=this.p3sdk_ad.sourcePlayer.position();t||(t=this.p3sdk_ad.status.interval),this.p3sdk_ad.status.heartbeat=setTimeout(function(){n.checkState(e+t)},t)},this.clearActionTimeout=function(){this.p3sdk_ad.status.actionTimeout&&clearTimeout(n.p3sdk_ad.status.actionTimeout),this.p3sdk_ad.status.actionTimeout=null},this.removeCanPlayListeners=function(){this.p3sdk_ad.descPlayer.getPlayer().removeEventListener("canplay",n.p3sdk_ad.descPlayer.onPlayReady),this.p3sdk_ad.descPlayer.getPlayer().removeEventListener("canplay",n.p3sdk_ad.descPlayer.onLoaded),this.p3sdk_ad.descPlayer.seekTo=null},this.seekActions=function(t){this.p3sdk_ad.sourceHandler.returnToSourceVol(),this.p3sdk_ad["debugger"].log("Seeking to "+t),this.p3sdk_ad.status.lastEvent={type:"seek",time:Date.now()};var e=this.p3sdk_ad.status.snippets[this.p3sdk_ad.status.snippets.length-1];0!==t||n.snipEndsBeforeSource(e)?(this.p3sdk_ad.status.pausedForSnip&&this.p3sdk_ad.sourcePlayer.play(),this.defibrillate()):this.p3sdk_ad.status.pausedForSnip=!0},this.resumeActions=function(){this.p3sdk_ad["debugger"].log("Source has resumed"),this.p3sdk_ad.status.lastEvent={type:"source_resumed",time:Date.now()},this.defibrillate()},this.pauseActions=function(){this.p3sdk_ad.status.lastEvent&&"user_pause"===this.p3sdk_ad.status.lastEvent.type||(this.p3sdk_ad["debugger"].log("Paused!!"),this.p3sdk_ad.status.lastEvent={type:"user_pause",time:Date.now()},this.stop(),this.setupHeartbeat())},this.defibrillate=function(){this.p3sdk_ad["debugger"].log("CLEAR!"),this.stop(),this.setupHeartbeat(),this.p3sdk_ad.status.currentSnippet&&n.triggerSnippet(this.p3sdk_ad.status.currentSnippet,!0)},this.syncSnippetStates=function(t){for(this.p3sdk_ad["debugger"].log("Syncing snippet states!"),this.p3sdk_ad.status.currentSnippet=null,t===undefined&&(t=this.p3sdk_ad.sourcePlayer.position()),ii=0;ii<this.p3sdk_ad.status.snippets.length;ii++){var e=this.p3sdk_ad.status.snippets[ii];e.end_time<t||e.end_time===t&&t>0?e.state="played":e.start_time<=t?(e.state="paused",this.p3sdk_ad.status.currentSnippet=e):e.state="paused"}},this.resumeSource=function(){this.p3sdk_ad.status.lastEvent={type:"resume_source",time:Date.now()},this.p3sdk_ad["debugger"].log("Resuming source"),this.p3sdk_ad.status.pausedForSnip=!1,this.p3sdk_ad.sourcePlayer.play()},this.setupNextAction=function(t){var e=n.findNextAction(t);if(!e)return!1;if(!e.snippet||!e.snippet.audio_snippet_id)throw"Snippet audio at ("+e.snippet.start_time+") not found!";if(!this.p3sdk_ad.status.nextAction||e.action==this.p3sdk_ad.status.nextAction.action&&e.snippet.audio_snippet_id==this.p3sdk_ad.status.nextAction.snippet.audio_snippet_id||this.p3sdk_ad["debugger"].log("Setting up "+e.action+" action for t-minus "+e.t_minus+" ms"),this.p3sdk_ad.status.nextAction=e,this.clearActionTimeout(),e.t_minus<-5e3)this.p3sdk_ad["debugger"].log("CODE BLUE!"),this.defibrillate(t);else if("play_snip"===e.action)this.setupPlayTimeout(e);else if("pause_source"===e.action||"delay_source"===e.action)this.setupPauseTimeout(e);else{if("end_snip"!==e.action)throw"Unknown action "+e.action;this.setupEndSnipTimeout(e)}},this.setupPlayTimeout=function(t){if(!n.shouldPerformSnipAction(t.snippet))return!1;n.p3sdk_ad.status.actionTimeout=setTimeout(function(){if(!n.shouldPerformSnipAction(t.snippet))return!1;n.p3sdk_ad["debugger"].log("Play timeout triggered for snip at "+t.snippet.start_time),n.triggerSnippet(t.snippet,!1),n.checkState(t.snippet.start_time)},t.t_minus)},this.setupPauseTimeout=function(t){if(!n.shouldPerformSnipAction(t.snippet))return!1;this.p3sdk_ad.status.actionTimeout=setTimeout(function(){if(!n.shouldPerformSnipAction(t.snippet))return!1;var e="delay_source"===t.action?"sync":"pausing snip";n.p3sdk_ad["debugger"].log("Pause timeout triggered for "+e),n.pauseSourceForSnippet(t.snippet),n.checkState(t.snippet.end_time)},t.t_minus)},this.setupEndSnipTimeout=function(t){this.p3sdk_ad.status.actionTimeout=setTimeout(function(){n.p3sdk_ad["debugger"].log("End snippet timeout triggered at "+t.snippet.end_time),n.p3sdk_ad.descPlayer.pause(),n.p3sdk_ad.settings.equalizer_on&&n.p3sdk_ad.sourceHandler.fadeVolumeUp(),t.snippet.state="played",n.p3sdk_ad.status.currentSnippet=null,n.shouldResumeSource(t.snippet)&&n.resumeSource(),n.checkState(t.snippet.end_time)},t.t_minus)},this.triggerSnippet=function(t,e){this.p3sdk_ad["debugger"].log("Triggering snippet at "+t.start_time),this.p3sdk_ad.status.currentSnippet=t,t.end_time===t.start_time&&this.pauseSourceForSnippet(t);var n=0;e&&(n=this.p3sdk_ad.sourcePlayer.position()-t.start_time,this.p3sdk_ad["debugger"].log("Seeking to "+n+" in snippet")),this.p3sdk_ad.descPlayer.seek(t.start_time+t.delay+n),this.p3sdk_ad["debugger"].log("Ready to play, playing snippet!"),this.playSnippet(t)},this.playSnippet=function(t){return("PAUSED"!=n.p3sdk_ad.sourcePlayer.play_state()||0!=n.p3sdk_ad.sourcePlayer.duration())&&("playing"!==t.state&&"played"!==t.state&&(this.p3sdk_ad["debugger"].log("Playing snippet, position "+this.p3sdk_ad.descPlayer.position()),this.p3sdk_ad.settings.equalizer_on&&this.p3sdk_ad.sourceHandler.fadeVolumeDown(),this.p3sdk_ad.descPlayer.play(),void(t.state="playing")))},this.pauseSnippet=function(){this.p3sdk_ad["debugger"].log("Pausing the snip"),this.p3sdk_ad.descPlayer.pause(),this.p3sdk_ad.status.currentSnippet&&(this.p3sdk_ad.status.currentSnippet.state="paused"),this.p3sdk_ad.status.pausedForSnip=!1},this.pauseSourceForSnippet=function(t){if("played"===t.state||!n.shouldPerformSnipAction(t))return!1;this.p3sdk_ad.status.lastEvent={type:"pause_for_snip",time:Date.now()},this.p3sdk_ad.sourcePlayer.pause(),this.p3sdk_ad.status.pausedForSnip=!0}},p3sdk.source_handler=function(t){this.p3sdk_ad=t;var e=this;this.source_volume=null,this.fadeVolumeDown=function(t){if(e.source_volume=e.p3sdk_ad.sourcePlayer.get_volume(),t||(t=.8*e.p3sdk_ad.sourcePlayer.get_volume()),n)return!1;var n=setInterval(function(){var i=e.p3sdk_ad.sourcePlayer.get_volume();(i<=t||i<=0)&&clearInterval(n),i-=.1,e.p3sdk_ad.sourcePlayer.set_volume(i)},10)},this.fadeVolumeUp=function(t){if(t||(t=1.2*e.p3sdk_ad.sourcePlayer.get_volume()),n)return!1;var n=setInterval(function(){var i=e.p3sdk_ad.sourcePlayer.get_volume();(i>=t||i>=1)&&clearInterval(n),i+=.1,e.p3sdk_ad.sourcePlayer.set_volume(i)},10)},this.returnToSourceVol=function(){var t=e.p3sdk_ad.sourcePlayer.get_volume(),n=e.source_volume;t>n?this.fadeVolumeDown(n):this.fadeVolumeUp(n)}},p3sdk.source_handler_promise=function(t){this.p3sdk_ad=t;var e=this;this.source_volume=null,this.fadeVolumeDown=function(t=null){null==t?e.p3sdk_ad.sourcePlayer.get_volume().then(function(n){e.source_volume=n,t=.8*n,e.fadeVolumeDownActions(t)}):e.fadeVolumeDownActions(t)},this.fadeVolumeDownActions=function(t){if(n)return!1;var n=setInterval(function(){e.p3sdk_ad.sourcePlayer.get_volume().then(function(i){(i<=t||i<=0)&&clearInterval(n),i-=.1,e.p3sdk_ad.sourcePlayer.set_volume(i).then(function(){})["catch"](function(t){t.name})})},100)},this.fadeVolumeUp=function(t=null){null==t?e.p3sdk_ad.sourcePlayer.get_volume().then(function(n){t=1.2*n,e.fadeVolumeUpActions(t)}):e.fadeVolumeUpActions(t)},this.fadeVolumeUpActions=function(t){if(n)return!1;var n=setInterval(function(){e.p3sdk_ad.sourcePlayer.get_volume().then(function(i){(i>=t||i>=1)&&clearInterval(n),i+=.1,e.p3sdk_ad.sourcePlayer.set_volume(i).then(function(){})["catch"](function(t){t.name})})},100)},this.returnToSourceVol=function(){e.p3sdk_ad.sourcePlayer.get_volume().then(function(t){var n=e.source_volume;t>n?e.fadeVolumeDown(n):e.fadeVolumeUp(n)})}},p3$(document).ready(function(){"undefined"!=typeof p3sdk_before_init&&p3sdk_before_init(),p3sdk.init(),p3sdk.ready=!0,"undefined"!=typeof p3sdk_ready&&p3sdk_ready(p3sdk);for(var t=0;t<p3sdk.instances.length;t++)p3$(p3sdk.instances[t]).trigger("p3sdk:ready",{})});
